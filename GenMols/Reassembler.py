from rdkit import Chem
from rdkit.Chem import AllChem
from rdkit.Chem import Draw
from rdkit.Chem.Draw import IPythonConsole
from rdkit.Chem.Draw import MolDrawing, DrawingOptions
from rdkit.Chem.SimpleEnum import Enumerator
from rdkit.Chem import rdMolDescriptors
import pandas as pd
import numpy as np
import itertools
import random
import math
import os
    
    
def assemble(molecule1, molecule2, sites, returnfile=False):
    """
    Args:
    molecule1= first fragment to be merged (mol object);
    molecule2= second fragment to be merged (mol object)
    sites= number of connections made (i.e. sites = n, where n is the number of individual atom pairs being fused together)
    returnfile: if False, then assembly products are return as mol objects, otherwise if True returns a file with product InChi
    
    Before assembling the molecules, Reassembler is initialized by transforming the reaction SMARTS strings into RDKit reaction objects
    SMARTS1 is the list of n=1 reaction SMARTS, rxn1 is the list of reactions defined by those SMARTS
    SMARTS2 is the list of n=2 reactions, rxn2 is the list of reactions defined by those SMARTS
    SMARTS3 is the list of origami reactions, rxn3 is the list of reactions defined by those SMARTS
    These lists are merged into one list of lists, where SMARTS[0] is SMARTS1, SMARTS[1] is SMARTS2 and SMARTS[2] is SMARTS3
    Therefore, in the rxn list of lists, rxn[0] are n=1 reactions, rxn[1] are n=2 reactions and rxn[2] are origami reactions
    """

    mol1 = [molecule1]
    mol2 = [molecule2]
        
    SMARTS1=[None]*14
    SMARTS2=[None]*512
    SMARTS3=[None]*14
    SMARTS=[SMARTS1, SMARTS2, SMARTS3]

    #carbon sp3
    SMARTS[0][0]='[CH:1]([*:2])([*:3])[*:4].[CH3:5][*:6]>>[C:1]([*:2])([*:3])([*:4])[*:6].[CH4:5]' #1
    SMARTS[0][1]='[CH2:1]([*:2])[*:3].[CH2:4]([*:5])[*:6]>>[C:1]([*:2])([*:3])([*:5])[*:6].[CH4:4]' #2
    SMARTS[0][2]='[CH2:1]([*:2])[*:3].[CH3:4][*:5]>>[CH:1]([*:2])([*:3])[*:5].[CH4:4]' #3
    SMARTS[0][3]='[CH3:1][*:2].[CH3:4][*:5]>>[CH2:1]([*:2])[*:5].[CH4:4]' #4

    # carbon sp2
    SMARTS[0][4]='[CH:1](=[*:2])[*:3].[CH3:4][*:5]>>[C:1](=[*:2])([*:3])[*:5].[CH4:4]' #5
    SMARTS[0][5]='[CH2:1]=[*:2].[CH2:3]([*:4])[*:5]>>[C:1](=[*:2])([*:4])[*:5].[CH4:3]' #6
    SMARTS[0][6]='[CH2:1]=[*:2].[CH3:3][*:4]>>[CH:1](=[*:2])[*:4].[CH4:3]' #7
    SMARTS[0][7]='[CH2:1]=[*:2].[CH2:3]=[*:4]>>[C:1](=[*:2])=[*:4].[CH4:3]' #8

    #carbon sp
    SMARTS[0][8]='[CH:1]#[*:2].[CH3:3][*:4]>>[C:1](#[*:2])[*:4].[CH4:3]' #9

    #nitrogen
    SMARTS[0][9]='[NH:1]([*:2])[*:3].[NH2:4][*:5]>>[N:1]([*:2])([*:3])[*:5].[NH3:4]' #10
    SMARTS[0][10]='[NH2:1][*:2].[NH2:3][*:4]>>[NH:1]([*:2])[*:4].[NH3:3]' #11
    SMARTS[0][11]='[NH:1]=[*:2].[NH2:3][*:4]>>[N:1](=[*:2])[*:4].[NH3:3]' #12
    SMARTS[0][12]='[N:1]#[*:2].[NH:3]=[*:4]>>[N:1](#[*:2])=[*:4].[NH3:4]' #13

    #oxygen
    SMARTS[0][13]='[OH:1][*:2].[OH:3][*:4]>>[O:1]([*:2])[*:4].[OH2:3]' #14

    #carbon sp3
    SMARTS[1][0]='([CH:1]([*:2])([*:3])[*:4].[CH:5]([*:6])([*:7])[*:8]).([CH3:9][*:10].[CH3:11][*:12])>>([C:1]([*:2])([*:3])([*:4])[*:10].[C:5]([*:6])([*:7])([*:8])[*:12]).[CH3:9][CH3:11]' #1-1
    SMARTS[1][1]='([CH:1]([*:2])([*:3])[*:4].[CH3:5][*:6]).([CH3:7][*:8].[CH:9]([*:10])([*:11])[*:12])>>([C:1]([*:2])([*:3])([*:4])[*:8].[C:5]([*:6])([*:10])([*:11])[*:12]).[CH3:7][CH3:9]' #1-1
    SMARTS[1][2]='([CH2:1]([*:2])[*:3].[CH2:4]([*:5])[*:6]).([CH2:7]([*:8])[*:9].[CH2:10]([*:11])[*:12])>>([C:1]([*:2])([*:3])([*:8])[*:9].[C:4]([*:5])([*:6])([*:11])[*:12]).[CH3:7][CH3:10]' #2-2
    SMARTS[1][3]='([CH2:1]([*:2])[*:3].[CH2:4]([*:5])[*:6]).([CH3:7][*:8].[CH3:9][*:10])>>([CH:1]([*:2])([*:3])[*:8].[CH:4]([*:5])([*:6])[*:10]).[CH3:7][CH3:9]' #3-3
    SMARTS[1][4]='([CH2:1]([*:2])[*:3].[CH3:4][*:5]).([CH3:6][*:7].[CH2:8]([*:9])[*:10])>>([CH:1]([*:2])([*:3])[*:7].[CH:4]([*:5])([*:9])[*:10]).[CH3:6][CH3:8]' #3-3
    SMARTS[1][5]='([CH3:1][*:2].[CH3:3][*:4]).([CH3:5][*:6].[CH3:7][*:8])>>([CH2:1]([*:2])[*:6].[CH2:3]([*:4])[*:8]).[CH3:5][CH3:7]' #4-4

    #carbon sp2
    SMARTS[1][6]='([CH:1](=[*:2])[*:3].[CH:4](=[*:5])[*:6]).([CH3:7][*:8].[CH3:9][*:10])>>([C:1](=[*:2])([*:3])[*:8].[C:4](=[*:5])([*:6])[*:10]).[CH3:7][CH3:9]' #5-5
    SMARTS[1][7]='([CH:1](=[*:2])[*:3].[CH3:4][*:5]).([CH3:6][*:7].[CH:8](=[*:9])[*:10])>>([C:1](=[*:2])([*:3])[*:7].[C:4](=[*:9])([*:5])[*:10]).[CH3:6][CH3:8]' #5-5
    SMARTS[1][8]='([CH2:1]=[*:2].[CH2:3]=[*:4]).([CH2:5]([*:6])[*:7].[CH2:8]([*:9])[*:10])>>([C:1](=[*:2])([*:6])[*:7].[C:3](=[*:4])([*:9])[*:10]).[CH3:5][CH3:8]' #6-6
    SMARTS[1][9]='([CH2:1]=[*:2].[CH2:3]([*:4])[*:5]).([CH2:6]([*:7])[*:8].[CH2:9]=[*:10])>>([C:1](=[*:2])([*:7])[*:8].[C:3]([*:4])([*:5])=[*:10]).[CH3:6][CH3:9]' #6-6
    SMARTS[1][10]='([CH2:1]=[*:2].[CH2:3]=[*:4]).([CH3:5][*:6].[CH3:7][*:8])>>([CH:1](=[*:2])[*:6].[CH:3](=[*:4])[*:8]).[CH3:5][CH3:7]' #7-7
    SMARTS[1][11]='([CH2:1]=[*:2].[CH3:3][*:4]).([CH3:5][*:6].[CH2:7]=[*:8])>>([CH:1](=[*:2])[*:6].[CH1:3]([*:4])=[*:8]).[CH3:5][CH3:7]'#7-7
    SMARTS[1][12]='([CH2:1]=[*:2].[CH2:3]=[*:4]).([CH2:5]=[*:6].[CH2:7]=[*:8])>>([C:1](=[*:2])=[*:6].[C:3](=[*:4])=[*:8]).[CH3:5][CH3:7]' #8-8

    #carbon sp
    SMARTS[1][13]='([CH:1]#[*:2].[CH:3]#[*:4]).([CH3:5][*:6].[CH3:7][*:8])>>([C:1](#[*:2])[*:6].[C:3](#[*:4])[*:8]).[CH3:5][CH3:7]' #9-9
    SMARTS[1][14]='([CH:1]#[*:2].[CH3:3][*:4]).([CH3:5][*:6].[CH:7]#[*:8])>>([C:1](#[*:2])[*:6].[C:3](#[*:8])[*:4]).[CH3:5][CH3:7]' #9-9

    #nitrogen
    SMARTS[1][15]='([NH:1]([*:2])[*:3].[NH:4]([*:5])[*:6]).([NH2:7][*:8].[NH2:9][*:10])>>([N:1]([*:2])([*:3])[*:8].[N:4]([*:5])([*:6])[*:10]).[NH2:7][NH2:9]' #10-10
    SMARTS[1][16]='([NH:1]([*:2])[*:3].[NH2:4][*:5]).([NH2:6][*:7].[NH:8]([*:9])[*:10])>>([N:1]([*:2])([*:3])[*:7].[N:4]([*:5])([*:9])[*:10]).[NH2:6][NH2:8]' #10-10
    SMARTS[1][17]='([NH2:1][*:2].[NH2:3][*:4]).([NH2:5][*:6].[NH2:7][*:8])>>([NH:1]([*:2])[*:6].[NH:3]([*:4])[*:8]).[NH2:5][NH2:7]' #11-11
    SMARTS[1][18]='([NH:1]=[*:2].[NH:3]=[*:4]).([NH2:5][*:6].[NH2:7][*:8])>>([N:1](=[*:2])[*:6].[N:3](=[*:4])[*:8]).[NH2:5][NH2:7]' #12-12
    SMARTS[1][19]='([NH:1]=[*:2].[NH2:3][*:4]).([NH2:5][*:6].[NH:7]=[*:8])>>([N:1](=[*:2])[*:6].[N:3]([*:4])=[*:8]).[NH2:5][NH2:7]' #12-12 
    SMARTS[1][20]='([N:1]#[*:2].[N:3]#[*:4]).([NH:5]=[*:6].[NH:7]=[*:8])>>([N:1](#[*:2])=[*:6].[N:3](#[*:4])=[*:8]).[NH2:5][NH2:7]' #13-13
    SMARTS[1][21]='([N:1]#[*:2].[NH:3]=[*:4]).([NH:5]=[*:6].[N:7]#[*:8])>>([N:1](#[*:2])=[*:6].[N:3](=[*:4])#[*:8]).[NH2:5][NH2:7]' #13-13

    #oxygen
    SMARTS[1][22]='([OH:1][*:2].[OH:3][*:4]).([OH:5][*:6].[OH:7][*:8])>>([O:1]([*:2])[*:6].[O:3]([*:4])[*:8]).[OH:5][OH:7]' #14-14

    #carbon crossreactions
    SMARTS[1][23]='([CH:1]([*:2])([*:3])[*:4].[CH2:5]([*:6])[*:7]).([CH3:8][*:9].[CH2:10]([*:11])[*:12])>>([C:1]([*:2])([*:3])([*:4])[*:9].[C:5]([*:6])([*:7])([*:11])[*:12]).[CH3:8][CH3:10]' #1-2
    SMARTS[1][24]='([CH:1]([*:2])([*:3])[*:4].[CH2:5]([*:6])[*:7]).([CH3:8][*:9].[CH3:10][*:11])>>([C:1]([*:2])([*:3])([*:4])[*:9].[CH:5]([*:6])([*:7])[*:11]).[CH3:8][CH3:10]' #1-3
    SMARTS[1][25]='([CH:1]([*:2])([*:3])[*:4].[CH3:5][*:6]).([CH3:7][*:8].[CH2:9]([*:10])[*:11])>>([C:1]([*:2])([*:3])([*:4])[*:8].[CH:5]([*:6])([*:10])[*:11]).[CH3:7][CH3:9]' #1-3
    SMARTS[1][26]='([CH:1]([*:2])([*:3])[*:4].[CH3:5][*:6]).([CH3:7][*:8].[CH3:9][*:10])>>([C:1]([*:2])([*:3])([*:4])[*:8].[C:5]([*:6])[*:10]).[CH3:7][CH3:9]' #1-4
    SMARTS[1][27]='([CH:1]([*:2])([*:3])[*:4].[CH:5](=[*:6])[*:7]).([CH3:8][*:9].[CH3:10][*:11])>>([C:1]([*:2])([*:3])([*:4])[*:9].[C:5](=[*:6])([*:7])[*:11]).[CH3:8][CH3:10]' #1-5
    SMARTS[1][28]='([CH:1]([*:2])([*:3])[*:4].[CH3:5][*:6]).([CH3:7][*:8].[CH:9](=[*:10])[*:11])>>([C:1]([*:2])([*:3])([*:4])[*:8].[C:5]([*:6])(=[*:10])[*:11]).[CH3:7][CH3:9]' #1-5
    SMARTS[1][29]='([CH:1]([*:2])([*:3])[*:4].[CH2:5]=[*:6]).([CH3:7][*:8].[CH2:9]([*:10])[*:11])>>([C:1]([*:2])([*:3])([*:4])[*:8].[C:5](=[*:6])([*:10])[*:11]).[CH3:7][CH3:9]' #1-6
    SMARTS[1][30]='([CH:1]([*:2])([*:3])[*:4].[CH2:5]([*:6])[*:7]).([CH3:8][*:9].[CH2:10]=[*:11])>>([C:1]([*:2])([*:3])([*:4])[*:9].[C:5]([*:6])([*:7])=[*:11]).[CH3:8][CH3:10]' #1-6
    SMARTS[1][31]='([CH:1]([*:2])([*:3])[*:4].[CH2:5]=[*:6]).([CH3:7][*:8].[CH3:9][*:10])>>([C:1]([*:2])([*:3])([*:4])[*:8].[CH:5](=[*:6])[*:10]).[CH3:7][CH3:9]' #1-7
    SMARTS[1][32]='([CH:1]([*:2])([*:3])[*:4].[CH3:5][*:6]).([CH3:7][*:8].[CH2:9]=[*:10])>>([C:1]([*:2])([*:3])([*:4])[*:8].[CH:5]([*:6])=[*:10]).[CH3:7][CH3:9]' #1-7
    SMARTS[1][33]='([CH:1]([*:2])([*:3])[*:4].[CH2:5]=[*:6]).([CH3:7][*:8].[CH2:9]=[*:10])>>([C:1]([*:2])([*:3])([*:4])[*:8].[C:5](=[*:6])(=[*:10])).[CH3:7][CH3:9]' #1-8
    SMARTS[1][34]='([CH:1]([*:2])([*:3])[*:4].[CH:5]#[*:6]).([CH3:7][*:8].[CH3:9][*:10])>>([C:1]([*:2])([*:3])([*:4])[*:8].[C:5](#[*:6])[*:10]).[CH3:7][CH3:9]' #1-9
    SMARTS[1][35]='([CH:1]([*:2])([*:3])[*:4].[CH3:5][*:6]).([CH3:7][*:8].[CH:9]#[*:10])>>([C:1]([*:2])([*:3])([*:4])[*:8].[C:5]([*:6])#[*:10]).[CH3:7][CH3:9]' #1-9

    SMARTS[1][36]='([CH2:1]([*:2])[*:3].[CH2:4]([*:5])[*:6]).([CH2:7]([*:8])[*:9].[CH3:10][*:11])>>([C:1]([*:2])([*:3])([*:8])[*:9].[CH:4]([*:5])([*:6])[*:11]).[CH3:7][CH3:10]' #2-3
    SMARTS[1][37]='([CH2:1]([*:2])[*:3].[CH3:4][*:5]).([CH2:6]([*:7])[*:8].[CH3:9][*:10])>>([C:1]([*:2])([*:3])([*:7])[*:8].[CH2:4]([*:5])[*:10]).[CH3:6][CH3:9]' #2-4
    SMARTS[1][38]='([CH2:1]([*:2])[*:3].[CH:4](=[*:5])[*:6]).([CH2:7]([*:8])[*:9].[CH3:10][*:11])>>([C:1]([*:2])([*:3])([*:8])[*:9].[C:4](=[*:5])([*:6])[*:11]).[CH3:7][CH3:10]' #2-5
    SMARTS[1][39]='([CH2:1]([*:2])[*:3].[CH2:4]=[*:5]).([CH2:6]([*:7])[*:8].[CH2:9]([*:10])[*:11])>>([C:1]([*:2])([*:3])([*:7])[*:8].[C:4](=[*:5])([*:10])[*:11]).[CH3:6][CH3:9]' #2-6
    SMARTS[1][40]='([CH2:1]([*:2])[*:3].[CH2:4]=[*:5]).([CH2:6]([*:7])[*:8].[CH3:9][*:10])>>([C:1]([*:2])([*:3])([*:7])[*:8].[CH:4](=[*:5])[*:10]).[CH3:6][CH3:9]' #2-7
    SMARTS[1][41]='([CH2:1]([*:2])[*:3].[CH2:4]=[*:5]).([CH2:6]([*:7])[*:8].[CH2:9]=[*:10])>>([C:1]([*:2])([*:3])([*:7])[*:8].[C:4](=[*:5])=[*:10]).[CH3:6][CH3:9]' #2-8
    SMARTS[1][42]='([CH2:1]([*:2])[*:3].[CH:4]#[*:5]).([CH2:6]([*:7])[*:8].[CH3:9][*:10])>>([C:1]([*:2])([*:3])([*:7])[*:8].[C:4](#[*:5])[*:10]).[CH3:6][CH3:9]' #1-9

    SMARTS[1][43]='([CH2:1]([*:2])[*:3].[CH3:4][*:5]).([CH3:6][*:7].[CH3:8][*:9])>>([CH:1]([*:2])([*:3])[*:7].[CH2:4]([*:5])[*:9]).[CH3:6][CH3:8]' #3-4                                   
    SMARTS[1][44]='([CH2:1]([*:2])[*:3].[CH:4](=[*:5])[*:6]).([CH3:7][*:8].[CH3:9][*:10])>>([CH:1]([*:2])([*:3])[*:8].[C:4](=[*:5])([*:6])[*:10]).[CH3:7][CH3:9]' #3-5
    SMARTS[1][45]='([CH2:1]([*:2])[*:3].[CH3:4][*:5]).([CH3:6][*:7].[CH:8](=[*:9])[*:10])>>([CH:1]([*:2])([*:3])[*:7].[C:4]([*:5])(=[*:9])[*:10]).[CH3:6][CH3:8]' #3-5
    SMARTS[1][46]='([CH2:1]([*:2])[*:3].[CH2:4]=[*:5]).([CH3:6][*:7].[CH2:8]([*:9])[*:10])>>([CH:1]([*:2])([*:3])[*:7].[C:4](=[*:5])([*:9])[*:10]).[CH3:6][CH3:8]' #3-6
    SMARTS[1][47]='([CH2:1]([*:2])[*:3].[CH2:4]([*:5])[*:6]).([CH3:7][*:8].[CH2:9]=[*:10])>>([CH1:1]([*:2])([*:3])[*:8].[C:4](=[*:10])([*:5])[*:6]).[CH3:7][CH3:9]' #3-6
    SMARTS[1][48]='([CH2:1]([*:2])[*:3].[CH2:4]=[*:5]).([CH3:6][*:7].[CH3:8][*:9])>>([CH:1]([*:2])([*:3])[*:7].[CH:4](=[*:5])[*:9]).[CH3:6][CH3:8]' #3-7
    SMARTS[1][49]='([CH2:1]([*:2])[*:3].[CH3:4][*:5]).([CH3:6][*:7].[CH2:8]=[*:9])>>([CH:1]([*:2])([*:3])[*:7].[CH:4]([*:5])=[*:9]).[CH3:6][CH3:8]' #3-7
    SMARTS[1][50]='([CH2:1]([*:2])[*:3].[CH2:4]=[*:5]).([CH3:6][*:7].[CH2:8]=[*:9])>>([CH:1]([*:2])([*:3])[*:7].[C:4](=[*:5])=[*:9]).[CH3:6][CH3:8]' #3-8
    SMARTS[1][51]='([CH2:1]([*:2])[*:3].[CH:4]#[*:5]).([CH3:6][*:7].[CH3:8][*:9])>>([CH:1]([*:2])([*:3])[*:7].[C:4](#[*:5])[*:9]).[CH3:6][CH3:8]' #3-9
    SMARTS[1][52]='([CH2:1]([*:2])[*:3].[CH3:4][*:5]).([CH3:6][*:7].[CH:8]#[*:9])>>([CH:1]([*:2])([*:3])[*:7].[C:4]([*:5])#[*:9]).[CH3:6][CH3:8]' #3-9

    SMARTS[1][53]='([CH3:1][*:2].[CH:3](=[*:4])[*:5]).([CH3:6][*:7].[CH3:8][*:9])>>([CH2:1]([*:2])[*:7].[C:3](=[*:4])([*:5])[*:9]).[CH3:6][CH3:8]' #4-5
    SMARTS[1][54]='([CH3:1][*:2].[CH2:3]=[*:4]).([CH3:5][*:6].[CH2:7]([*:8])[*:9])>>([CH2:1]([*:2])[*:6].[C:3](=[*:4])([*:8])[*:9]).[CH3:5][CH3:7]' #4-6
    SMARTS[1][55]='([CH3:1][*:2].[CH2:3]=[*:4]).([CH3:5][*:6].[CH3:7][*:8])>>([CH2:1]([*:2])[*:6].[CH:3](=[*:4])[*:8]).[CH3:5][CH3:7]' #4-7
    SMARTS[1][56]='([CH3:1][*:2].[CH2:3]=[*:4]).([CH3:5][*:6].[CH2:7]=[*:8])>>([CH2:1]([*:2])[*:6].[C:3](=[*:4])=[*:8]).[CH3:5][CH3:7]' #4-8
    SMARTS[1][57]='([CH3:1][*:2].[CH:3]#[*:4]).([CH3:5][*:6].[CH3:7][*:8])>>([CH2:1]([*:2])[*:6].[C:3](#[*:4])[*:8]).[CH3:5][CH3:7]' #4-9

    SMARTS[1][58]='([CH:1](=[*:2])[*:3].[CH2:4]=[*:5]).([CH3:6][*:7].[CH2:8]([*:9])[*:10])>>([C:1](=[*:2])([*:3])[*:7].[C:4](=[*:5])([*:9])[*:10]).[CH3:6][CH3:8]' #5-6
    SMARTS[1][59]='([CH:1](=[*:2])[*:3].[CH2:4]([*:5])[*:6]).([CH3:7][*:8].[CH2:9]=[*:10])>>([C:1](=[*:2])([*:3])[*:8].[C:4](=[*:10])([*:5])[*:6]).[CH3:7][CH3:9]' #5-6
    SMARTS[1][60]='([CH:1](=[*:2])[*:3].[CH2:4]=[*:5]).([CH3:6][*:7].[CH3:8][*:9])>>([C:1](=[*:2])([*:3])[*:7].[CH:4](=[*:5])[*:9]).[CH3:6][CH3:8]' #5-7
    SMARTS[1][61]='([CH:1](=[*:2])[*:3].[CH3:4][*:5]).([CH3:6][*:7].[CH2:8]=[*:9])>>([C:1](=[*:2])([*:3])[*:7].[CH:4]([*:5])=[*:9]).[CH3:6][CH3:8]' #5-7
    SMARTS[1][62]='([CH:1](=[*:2])[*:3].[CH2:4]=[*:5]).([CH3:6][*:7].[CH2:8]=[*:9])>>([C:1](=[*:2])([*:3])[*:7].[C:4](=[*:5])=[*:9]).[CH3:6][CH3:8]' #5-8
    SMARTS[1][63]='([CH:1](=[*:2])[*:3].[CH:4]#[*:5]).([CH3:6][*:7].[CH3:8][*:9])>>([C:1](=[*:2])([*:3])[*:7].[C:4](#[*:5])[*:9]).[CH3:6][CH3:8]' #5-9
    SMARTS[1][64]='([CH:1](=[*:2])[*:3].[CH3:4][*:5]).([CH3:6][*:7].[CH:8]#[*:9])>>([C:1](=[*:2])([*:3])[*:7].[C:4](#[*:9])[*:5]).[CH3:6][CH3:8]' #5-9

    SMARTS[1][65]='([CH2:1]=[*:2].[CH2:3]=[*:4]).([CH2:5]([*:6])[*:7].[CH3:8][*:9])>>([C:1](=[*:2])([*:6])[*:7].[CH:3](=[*:4])[*:9]).[CH3:5][CH3:8]' #6-7
    SMARTS[1][66]='([CH2:1]=[*:2].[CH3:3][*:4]).([CH2:5]([*:6])[*:7].[CH2:8]=[*:9])>>([C:1](=[*:2])([*:6])[*:7].[CH:3]([*:4])=[*:9]).[CH3:5][CH3:8]' #6-7
    SMARTS[1][67]='([CH2:1]=[*:2].[CH2:3]=[*:4]).([CH2:5]([*:6])[*:7].[CH2:8]=[*:9])>>([C:1](=[*:2])([*:6])[*:7].[C:3](=[*:4])=[*:9]).[CH3:5][CH3:8]' #6-8
    SMARTS[1][68]='([CH2:1]=[*:2].[CH:3]#[*:4]).([CH2:5]([*:6])[*:7].[CH3:8][*:9])>>([C:1](=[*:2])([*:6])[*:7].[C:3](#[*:4])[*:9]).[CH3:5][CH3:8]' #6-9
    SMARTS[1][69]='([CH2:1]=[*:2].[CH3:3][*:4]).([CH2:5]([*:6])[*:7].[CH:8]#[*:9])>>([C:1](=[*:2])([*:6])[*:7].[C:3]([*:4])#[*:9]).[CH3:5][CH3:8]' #6-9
    SMARTS[1][70]='([CH2:1]=[*:2].[CH2:3]=[*:4]).([CH3:5][*:6].[CH2:7]=[*:8])>>([CH:1](=[*:2])[*:6].[C:3](=[*:4])=[*:8]).[CH3:5][CH3:7]' #7-8
    SMARTS[1][71]='([CH2:1]=[*:2].[CH:3]#[*:4]).([CH3:5][*:6].[CH3:7][*:8])>>([CH:1](=[*:2])[*:6].[C:3](#[*:4])[*:8]).[CH3:5][CH3:7]' #7-9
    SMARTS[1][72]='([CH2:1]=[*:2].[CH3:3][*:4]).([CH3:5][*:6].[CH:7]#[*:8])>>([CH:1](=[*:2])[*:6].[C:3]([*:4])#[*:8]).[CH3:5][CH3:7]' #7-9
    SMARTS[1][73]='([CH2:1]=[*:2].[CH:3]#[*:4]).([CH3:5][*:6].[CH3:7][*:8])>>([CH:1](=[*:2])[*:6].[C:3](#[*:4])[*:8]).[CH3:5][CH3:7]' #8-9

    #nitrogen crossreactions
    SMARTS[1][74]='([NH:1]([*:2])[*:3].[NH2:4][*:5]).([NH2:6][*:7].[NH2:8][*:9])>>([N:1]([*:2])([*:3])[*:7].[NH:4]([*:5])[*:9]).[NH2:6][NH2:8]' #10-11
    SMARTS[1][75]='([NH:1]([*:2])[*:3].[NH:4]=[*:5]).([NH2:6][*:7].[NH2:8][*:9])>>([N:1]([*:2])([*:3])[*:7].[N:4](=[*:5])[*:9]).[NH2:6][NH2:8]' #10-12
    SMARTS[1][76]='([NH:1]([*:2])[*:3].[NH2:4][*:5]).([NH2:6][*:7].[NH:8]=[*:9])>>([N:1]([*:2])([*:3])[*:7].[N:4]([*:5])=[*:9]).[NH2:6][NH2:8]' #10-12
    SMARTS[1][77]='([NH:1]([*:2])[*:3].[N:4]#[*:5]).([NH2:6][*:7].[NH:8]=[*:9])>>([N:1]([*:2])([*:3])[*:7].[N:4](#[*:5])=[*:9]).[NH2:6][NH2:8]' #10-13
    SMARTS[1][78]='([NH:1]([*:2])[*:3].[NH:4]=[*:5]).([NH2:6][*:7].[N:8]#[*:9])>>([N:1]([*:2])([*:3])[*:7].[N:4](=[*:5])#[*:9]).[NH2:6][NH2:8]' #10-13
    SMARTS[1][79]='([NH2:1][*:2].[NH:3]=[*:4]).([NH2:5][*:6].[NH2:7][*:8])>>([NH:1]([*:2])[*:6].[N:3](=[*:4])[*:8]).[NH2:5][NH2:7]' #11-12
    SMARTS[1][80]='([NH2:1][*:2].[N:3]#[*:4]).([NH2:5][*:6].[NH:7]=[*:8])>>([NH:1]([*:2])[*:6].[N:3](#[*:4])=[*:8]).[NH2:5][NH2:7]' #11-13
    SMARTS[1][81]='([NH:1]=[*:2].[N:3]#[*:4]).([NH2:5][*:6].[NH:7]=[*:8])>>([N:1](=[*:2])[*:6].[N:3](#[*:4])=[*:8]).[NH2:5][NH2:7]' #12-13
    SMARTS[1][82]='([NH:1]=[*:2].[NH:3]=[*:4]).([NH2:5][*:6].[N:7]#[*:8])>>([N:1](=[*:2])[*:6].[N:3](=[*:4])#[*:8]).[NH2:5][NH2:7]' #12-13

    #carbon-nitrogen
    SMARTS[1][83]='([CH:1]([*:2])([*:3])[*:4].[NH:5]([*:6])[*:7]).([CH3:8][*:9].[NH2:10][*:11])>>([C:1]([*:2])([*:3])([*:4])[*:9].[N:5]([*:6])([*:7])[*:11]).[CH3:8][NH2:10]' #1-10
    SMARTS[1][84]='([CH:1]([*:2])([*:3])[*:4].[NH2:5][*:6]).([CH3:7][*:8].[NH:9]([*:10])[*:11])>>([C:1]([*:2])([*:3])([*:4])[*:8].[N:5]([*:6])([*:10])[*:11]).[CH3:7][NH2:9]' #1-10
    SMARTS[1][85]='([CH:1]([*:2])([*:3])[*:4].[NH2:5][*:6]).([CH3:7][*:8].[NH2:9][*:10])>>([C:1]([*:2])([*:3])([*:4])[*:8].[NH:5]([*:6])[*:10]).[CH3:7][NH2:9]' #1-11
    SMARTS[1][86]='([CH:1]([*:2])([*:3])[*:4].[NH:5]=[*:6]).([CH3:7][*:8].[NH2:9][*:10])>>([C:1]([*:2])([*:3])([*:4])[*:8].[N:5](=[*:6])[*:10]).[CH3:7][NH2:9]' #1-12
    SMARTS[1][87]='([CH:1]([*:2])([*:3])[*:4].[NH2:5][*:6]).([CH3:7][*:8].[NH:9]=[*:10])>>([C:1]([*:2])([*:3])([*:4])[*:8].[N:5]([*:6])=[*:10]).[CH3:7][NH2:9]' #1-12
    SMARTS[1][88]='([CH:1]([*:2])([*:3])[*:4].[N:5]#[*:6]).([CH3:7][*:8].[NH:9]=[*:10])>>([C:1]([*:2])([*:3])([*:4])[*:8].[N:5](#[*:6])=[*:10]).[CH3:7][NH2:9]' #1-13
    SMARTS[1][89]='([CH:1]([*:2])([*:3])[*:4].[NH:5]=[*:6]).([CH3:7][*:8].[NH:9]#[*:10])>>([C:1]([*:2])([*:3])([*:4])[*:8].[N:5](=[*:6])#[*:10]).[CH3:7][NH2:9]' #1-13

    SMARTS[1][90]='([CH2:1]([*:2])[*:3].[NH:4]([*:5])[*:6]).([CH2:7]([*:8])[*:9].[NH2:10][*:11])>>([C:1]([*:2])([*:3])([*:8])[*:9].[N:4]([*:5])([*:6])[*:11]).[CH3:7][NH2:10]' #2-10
    SMARTS[1][91]='([CH2:1]([*:2])[*:3].[NH2:4][*:5]).([CH2:6]([*:7])[*:8].[NH2:9][*:10])>>([C:1]([*:2])([*:3])([*:7])[*:8].[NH:4]([*:5])[*:10]).[CH3:6][NH2:9]' #2-11
    SMARTS[1][92]='([CH2:1]([*:2])[*:3].[NH:4]=[*:5]).([CH2:6]([*:7])[*:8].[NH2:9][*:10])>>([C:1]([*:2])([*:3])([*:7])[*:8].[N:4](=[*:5])[*:10]).[CH3:6][NH2:9]' #2-12
    SMARTS[1][93]='([CH2:1]([*:2])[*:3].[N:4]#[*:5]).([CH2:6]([*:7])[*:8].[NH:9]=[*:10])>>([C:1]([*:2])([*:3])([*:7])[*:8].[N:4](#[*:5])=[*:10]).[CH3:6][NH2:9]' #2-13

    SMARTS[1][94]='([CH2:1]([*:2])[*:3].[NH:4]([*:5])[*:6]).([CH3:7][*:8].[NH2:9][*:10])>>([C:1]([*:2])([*:3])[*:8].[N:4]([*:5])([*:6])[*:10]).[CH3:7][NH2:9]' #3-10
    SMARTS[1][95]='([CH2:1]([*:2])[*:3].[NH2:4][*:5]).([CH3:6][*:7].[NH:8]([*:9])[*:10])>>([CH:1]([*:2])([*:3])[*:7].[N:4]([*:5])([*:9])[*:10]).[CH3:6][NH2:8]' #3-10
    SMARTS[1][96]='([CH2:1]([*:2])[*:3].[NH2:4][*:5]).([CH3:6][*:7].[NH2:8][*:9])>>([CH:1]([*:2])([*:3])[*:7].[NH:4]([*:5])[*:9]).[CH3:6][NH2:8]' #3-11
    SMARTS[1][97]='([CH2:1]([*:2])[*:3].[NH:4]=[*:5]).([CH3:6][*:7].[NH2:8][*:9])>>([CH:1]([*:2])([*:3])[*:7].[N:4](=[*:5])[*:9]).[CH3:6][NH2:8]' #3-12
    SMARTS[1][98]='([CH2:1]([*:2])[*:3].[NH2:4][*:5]).([CH3:6][*:7].[NH:8]=[*:9])>>([CH:1]([*:2])([*:3])[*:7].[N:4]([*:5])=[*:9]).[CH3:6][NH2:8]' #3-12
    SMARTS[1][99]='([CH2:1]([*:2])[*:3].[N:4]#[*:5]).([CH3:6][*:7].[NH:8]=[*:9])>>([CH:1]([*:2])([*:3])[*:7].[N:4](#[*:5])=[*:9]).[CH3:6][NH2:8]' #3-13
    SMARTS[1][100]='([CH2:1]([*:2])[*:3].[NH:4]=[*:5]).([CH3:6][*:7].[N:8]#[*:9])>>([CH:1]([*:2])([*:3])[*:7].[N:4](=[*:5])#[*:9]).[CH3:6][NH2:8]' #3-13

    SMARTS[1][101]='([CH3:1][*:2].[NH:3]([*:4])[*:5]).([CH3:6][*:7].[NH2:8][*:9])>>([CH2:1]([*:2])[*:7].[N:3]([*:4])([*:5])[*:9]).[CH3:6][NH2:8]' #4-10
    SMARTS[1][102]='([CH3:1][*:2].[NH2:3][*:4]).([CH3:5][*:6].[NH2:7][*:8])>>([CH2:1]([*:2])[*:6].[NH:3]([*:4])[*:8]).[CH3:5][NH2:7]' #4-11
    SMARTS[1][103]='([CH3:1][*:2].[NH:3]=[*:4]).([CH3:5][*:6].[NH2:7][*:8])>>([CH2:1]([*:2])[*:6].[N:3](=[*:4])[*:8]).[CH3:5][NH2:7]' #4-12
    SMARTS[1][104]='([CH3:1][*:2].[N:3]#[*:4]).([CH3:5][*:6].[NH:7]=[*:8])>>([CH2:1]([*:2])[*:6].[N:3](#[*:4])=[*:8]).[CH3:5][NH2:7]' #4-13

    SMARTS[1][105]='([CH:1](=[*:2])[*:3].[NH:4]([*:5])[*:6]).([CH3:7][*:8].[NH2:9][*:10])>>([C:1](=[*:2])([*:3])[*:8].[N:4]([*:5])([*:6])[*:10]).[CH3:7][NH2:9]' #5-10
    SMARTS[1][106]='([CH:1](=[*:2])[*:3].[NH2:4][*:5]).([CH3:6][*:7].[NH:8]([*:9])[*:10])>>([C:1](=[*:2])([*:3])[*:7].[N:4]([*:5])([*:9])[*:10]).[CH3:6][NH2:8]' #5-10
    SMARTS[1][107]='([CH:1](=[*:2])[*:3].[NH2:4][*:5]).([CH3:6][*:7].[NH2:8][*:9])>>([C:1](=[*:2])([*:3])[*:7].[NH:4]([*:5])[*:9]).[CH3:6][NH2:8]' #5-11
    SMARTS[1][108]='([CH:1](=[*:2])[*:3].[NH:4]=[*:5]).([CH3:6][*:7].[NH2:8][*:9])>>([C:1](=[*:2])([*:3])[*:7].[N:4](=[*:5])[*:9]).[CH3:6][NH2:8]' #5-12
    SMARTS[1][109]='([CH:1](=[*:2])[*:3].[NH2:4][*:5]).([CH3:6][*:7].[NH:8]=[*:9])>>([C:1](=[*:2])([*:3])[*:7].[N:4](=[*:9])[*:5]).[CH3:6][NH2:8]' #5-12
    SMARTS[1][110]='([CH:1](=[*:2])[*:3].[N:4]#[*:5]).([CH3:6][*:7].[NH:8]=[*:9])>>([C:1](=[*:2])([*:3])[*:7].[N:4](#[*:5])=[*:9]).[CH3:6][NH2:8]' #5-13
    SMARTS[1][111]='([CH:1](=[*:2])[*:3].[NH:4]=[*:5]).([CH3:6][*:7].[N:8]#[*:9])>>([C:1](=[*:2])([*:3])[*:7].[N:4](=[*:5])#[*:9]).[CH3:6][NH2:8]' #5-13

    SMARTS[1][112]='([CH2:1]=[*:2].[NH:3]([*:4])[*:5]).([CH2:6]([*:7])[*:8].[NH2:9][*:10])>>([C:1](=[*:2])([*:7])[*:8].[N:3]([*:4])([*:5])[*:10]).[CH3:6][NH2:9]' #6-10
    SMARTS[1][113]='([CH2:1]=[*:2].[NH2:3][*:4]).([CH2:5]([*:6])[*:7].[NH:8]([*:9])[*:10])>>([C:1](=[*:2])([*:6])[*:7].[N:3]([*:4])([*:9])[*:10]).[CH3:5][NH2:8]' #6-10
    SMARTS[1][114]='([CH2:1]=[*:2].[NH2:3][*:4]).([CH2:5]([*:6])[*:7].[NH2:8][*:9])>>([C:1](=[*:2])([*:6])[*:7].[NH:3]([*:4])[*:9]).[CH3:5][NH2:8]' #6-11
    SMARTS[1][115]='([CH2:1]=[*:2].[NH:3]=[*:4]).([CH2:5]([*:6])[*:7].[NH2:8][*:9])>>([C:1](=[*:2])([*:6])[*:7].[N:3](=[*:4])[*:9]).[CH3:5][NH2:8]' #6-12
    SMARTS[1][116]='([CH2:1]=[*:2].[NH2:3][*:4]).([CH2:5]([*:6])[*:7].[NH:8]=[*:9])>>([C:1](=[*:2])([*:6])[*:7].[N:3]([*:4])=[*:9]).[CH3:5][NH2:8]' #6-12
    SMARTS[1][117]='([CH2:1]=[*:2].[N:3]#[*:4]).([CH2:5]([*:6])[*:7].[NH:8]=[*:9])>>([C:1](=[*:2])([*:6])[*:7].[N:3](#[*:4])=[*:9]).[CH3:5][NH2:8]' #6-13
    SMARTS[1][118]='([CH2:1]=[*:2].[NH:3]=[*:4]).([CH2:5]([*:6])[*:7].[N:8]#[*:9])>>([C:1](=[*:2])([*:6])[*:7].[N:3](=[*:4])#[*:9]).[CH3:5][NH2:8]' #6-13

    SMARTS[1][119]='([CH2:1]=[*:2].[NH:3]([*:4])[*:5]).([CH3:6][*:7].[NH2:8][*:9])>>([CH:1](=[*:2])[*:7].[N:3]([*:4])([*:5])[*:9]).[CH3:6][NH2:8]' #7-10
    SMARTS[1][120]='([CH2:1]=[*:2].[NH2:3][*:4]).([CH3:5][*:6].[NH:7]([*:8])[*:9])>>([CH:1](=[*:2])[*:6].[N:3]([*:4])([*:8])[*:9]).[CH3:5][NH2:7]' #7-10
    SMARTS[1][121]='([CH2:1]=[*:2].[NH2:3][*:4]).([CH3:5][*:6].[NH2:7][*:8])>>([CH:1](=[*:2])[*:6].[NH:3]([*:4])[*:8]).[CH3:5][NH2:7]' #7-11
    SMARTS[1][122]='([CH2:1]=[*:2].[NH:3]=[*:4]).([CH3:5][*:6].[NH2:7][*:8])>>([CH:1](=[*:2])[*:6].[N:3](=[*:4])[*:8]).[CH3:5][NH2:7]' #7-12
    SMARTS[1][123]='([CH2:1]=[*:2].[NH2:3][*:4]).([CH3:5][*:6].[NH:7]=[*:8])>>([CH:1](=[*:2])[*:6].[N:3]([*:4])=[*:8]).[CH3:5][NH2:7]' #7-12
    SMARTS[1][124]='([CH2:1]=[*:2].[N:3]#[*:4]).([CH3:5][*:6].[NH:7]=[*:8])>>([CH:1](=[*:2])[*:6].[N:3](#[*:4])=[*:8]).[CH3:5][NH2:7]' #7-13
    SMARTS[1][125]='([CH2:1]=[*:2].[NH:3]=[*:4]).([CH3:5][*:6].[N:7]#[*:8])>>([CH:1](=[*:2])[*:6].[N:3](=[*:4])#[*:8]).[CH3:5][NH2:7]' #7-13

    SMARTS[1][126]='([CH2:1]=[*:2].[NH:3]([*:4])[*:5]).([CH2:6]=[*:7].[NH2:8][*:9])>>([C:1](=[*:2])=[*:7].[N:3]([*:4])([*:5])[*:9]).[CH3:6][NH2:8]' #8-10
    SMARTS[1][127]='([CH2:1]=[*:2].[NH2:3][*:4]).([CH2:5]=[*:6].[NH2:7][*:8])>>([C:1](=[*:2])=[*:6].[NH:3]([*:4])[*:8]).[CH3:5][NH2:7]' #8-11
    SMARTS[1][128]='([CH2:1]=[*:2].[NH:3]=[*:4]).([CH2:5]=[*:6].[NH2:7][*:8])>>([C:1](=[*:2])=[*:6].[N:3](=[*:4])[*:8]).[CH3:5][NH2:7]' #8-12
    SMARTS[1][129]='([CH2:1]=[*:2].[N:3]#[*:4]).([CH2:5]=[*:6].[NH:7]=[*:8])>>([C:1](=[*:2])=[*:6].[N:3](#[*:4])=[*:8]).[CH3:5][NH2:7]' #8-13

    SMARTS[1][130]='([CH:1]#[*:2].[NH:3]([*:4])([*:5])).([CH3:6][*:7].[NH2:8][*:9])>>([C:1](#[*:2])[*:7].[N:3]([*:4])([*:5])[*:9]).[CH3:6][NH2:8]' #9-10
    SMARTS[1][131]='([CH:1]#[*:2].[NH2:3][*:4]).([CH3:5][*:6].[NH:7]([*:8])[*:9])>>([C:1](#[*:2])[*:6].[N:3]([*:4])([*:8])[*:9]).[CH3:5][NH2:7]' #9-10
    SMARTS[1][132]='([CH:1]#[*:2].[NH2:3][*:4]).([CH3:5][*:6].[NH2:7][*:8])>>([C:1](#[*:2])[*:6].[NH:3]([*:4])[*:8]).[CH3:5][NH2:7]' #9-11
    SMARTS[1][133]='([CH:1]#[*:2].[NH:3]=[*:4]).([CH3:5][*:6].[NH2:7][*:8])>>([C:1](#[*:2])[*:6].[N:3](=[*:4])[*:8]).[CH3:5][NH2:7]' #9-12
    SMARTS[1][134]='([CH:1]#[*:2].[NH2:3][*:4]).([CH3:5][*:6].[NH:7]=[*:8])>>([C:1](#[*:2])[*:6].[N:3]([*:4])=[*:8]).[CH3:5][NH2:7]' #9-12
    SMARTS[1][135]='([CH:1]#[*:2].[N:3]#[*:4]).([CH3:5][*:6].[NH:7]=[*:8])>>([C:1](#[*:2])=[*:6].[N:3](#[*:4])=[*:8]).[CH3:5][NH2:7]' #9-13
    SMARTS[1][136]='([CH:1]#[*:2].[NH:3]=[*:4]).([CH3:5][*:6].[N:7]#[*:8])>>([C:1](#[*:2])[*:6].[N:3](=[*:4])#[*:8]).[CH3:5][NH2:7]' #9-13

    #carbon-oxygen
    SMARTS[1][137]='([OH:1][*:2].[CH:3]([*:4])([*:5])[*:6]).([OH:7][*:8].[CH3:9][*:10])>>([O:1]([*:2])[*:8].[C:3]([*:4])([*:5])([*:6])[*:10]).[OH:7][CH3:9]' #1-14
    SMARTS[1][138]='([OH:1][*:2].[CH2:3]([*:4])[*:5]).([OH:6][*:7].[CH2:8]([*:9])[*:10])>>([O:1]([*:2])[*:7].[C:3]([*:4])([*:5])([*:9])[*:10]).[OH:6][CH3:8]' #2-14
    SMARTS[1][139]='([OH:1][*:2].[CH2:3]([*:4])[*:5]).([OH:6][*:7].[CH3:8][*:9])>>([O:1]([*:2])[*:7].[CH:3]([*:4])([*:5])[*:9]).[OH:6][CH3:8]' #3-14
    SMARTS[1][140]='([OH:1][*:2].[CH3:3][*:4]).([OH:5][*:6].[CH3:7][*:8])>>([O:1]([*:2])[*:6].[CH2:3]([*:4])[*:8]).[OH:5][CH3:7]' #4-14
    SMARTS[1][141]='([OH:1][*:2].[CH:3](=[*:4])[*:5]).([OH:6][*:7].[CH3:8][*:9])>>([O:1]([*:2])[*:7].[C:3](=[*:4])([*:5])[*:9]).[OH:6][CH3:8]' #5-14
    SMARTS[1][142]='([OH:1][*:2].[CH2:3]=[*:4]).([OH:5][*:6].[CH2:7]([*:8])[*:9])>>([O:1]([*:2])[*:6].[C:3](=[*:4])([*:8])[*:9]).[OH:5][CH3:7]' #6-14
    SMARTS[1][143]='([OH:1][*:2].[CH2:3]=[*:4]).([OH:5][*:6].[CH3:7][*:8])>>([O:1]([*:2])[*:6].[CH:3](=[*:4])[*:8]).[OH:5][CH3:7]' #7-14
    SMARTS[1][144]='([OH:1][*:2].[CH2:3]=[*:4]).([OH:5][*:6].[CH2:7]=[*:8])>>([O:1]([*:2])[*:6].[C:3](=[*:4])=[*:8]).[OH:5][CH3:7]' #8-14
    SMARTS[1][145]='([OH:1][*:2].[CH:3]#[*:4]).([OH:5][*:6].[CH3:7][*:8])>>([O:1]([*:2])[*:6].[C:3](#[*:4])[*:8]).[OH:5][CH3:7]' #9-14

    #nitrogen-oxygen
    SMARTS[1][146]='([OH:1][*:2].[NH:3]([*:4])[*:5]).([OH:6][*:7].[NH2:8][*:9])>>([O:1]([*:2])[*:7].[N:3]([*:4])([*:5])[*:9]).[OH:6][NH2:8]' #10-14
    SMARTS[1][147]='([OH:1][*:2].[NH2:3][*:4]).([OH:5][*:6].[NH2:7][*:8])>>([O:1]([*:2])[*:6].[NH:3]([*:4])[*:8]).[OH:5][NH2:7]' #11-14
    SMARTS[1][148]='([OH:1][*:2].[NH:3]=[*:4]).([OH:5][*:6].[NH2:7][*:8])>>([O:1]([*:2])[*:6].[N:3](=[*:4])[*:8]).[OH:5][NH2:7]' #12-14
    SMARTS[1][149]='([OH:1][*:2].[N:3]#[*:4]).([OH:5][*:6].[NH:7]=[*:8])>>([O:1]([*:2])[*:6].[N:3](#[*:4])=[*:8]).[OH:5][NH2:7]' #13-14

    #overlapping carbon crossreactions
    SMARTS[1][150]='[CH:1]([*:3])([*:4])[CH:2]([*:5])[*:6].([CH3:7][*:8].[CH3:9][*:10])>>[C:1]([*:3])([*:4])([*:8])[C:2]([*:5])([*:6])[*:10].[CH3:7][CH3:9]'
    SMARTS[1][151]='[CH:1]([*:3])([*:4])[CH2:2][*:5].([CH3:6][*:7].[CH2:8]([*:9])[*:10])>>[C:1]([*:3])([*:4])([*:7])[C:2]([*:5])([*:9])[*:10].[CH3:6][CH3:8]'
    SMARTS[1][152]='[CH:1]([*:3])([*:4])[CH2:2][*:5].([CH3:6][*:7].[CH2:8][*:9])>>[C:1]([*:3])([*:4])([*:7])[CH:2]([*:5])[*:9].[CH3:6][CH3:8]'
    SMARTS[1][153]='[CH:1]([*:3])([*:4])[CH2:2][*:5].([CH3:6][*:7].[CH2:8]=[*:9])>>[C:1]([*:3])([*:4])([*:7])[C:2]([*:5])=[*:9].[CH3:6][CH3:8]'
    SMARTS[1][154]='[CH2:1]([*:3])[CH2:2][*:4].([CH2:5]([*:6])[*:7].[CH2:8]([*:9])[*:10])>>[C:1]([*:3])([*:6])([*:7])[C:2]([*:4])([*:9])[*:10].[CH3:5][CH3:8]'
    SMARTS[1][155]='[CH2:1]([*:3])[CH2:2][*:4].([CH2:5]([*:6])[*:7].[CH3:8][*:9])>>[C:1]([*:3])([*:6])([*:7])[CH:2]([*:4])[*:9].[CH3:5][CH3:8]'
    SMARTS[1][156]='[CH2:1]([*:3])[CH2:2][*:4].([CH2:5]([*:6])[*:7].[CH2:8]=[*:9])>>[C:1]([*:3])([*:6])([*:7])[C:2]([*:4])=[*:9].[CH3:5][CH3:8]'
    SMARTS[1][157]='[CH2:1]([*:3])[CH2:2][*:4].([CH3:5][*:6].[CH3:7][*:8])>>[CH:1]([*:3])([*:6])[CH:2]([*:4])[*:8].[CH3:5][CH3:7]'
    SMARTS[1][158]='[CH2:1]([*:3])[CH2:2][*:4].([CH3:5][*:6].[CH2:7]=[*:8])>>[CH:1]([*:3])([*:6])[C:2]([*:4])=[*:8].[CH3:5][CH3:7]'
    SMARTS[1][159]='[CH2:1]([*:3])[CH2:2][*:4].([CH2:5]=[*:6].[CH2:7]=[*:8])>>[C:1]([*:3])(=[*:6])[C:2]([*:4])=[*:8].[CH3:5][CH3:7]'

    SMARTS[1][160]='[CH2:1]([*:3])[CH3:2].([CH2:4]([*:5])[*:6].[CH:7]([*:8])([*:9])[*:10])>>[C:1]([*:3])([*:5])([*:6])[C:2]([*:8])([*:9])[*:10].[CH3:4][CH3:7]'
    SMARTS[1][161]='[CH2:1]([*:3])[CH3:2].([CH3:4][*:5].[CH:6]([*:7])([*:8])[*:9])>>[CH:1]([*:3])([*:5])[C:2]([*:7])([*:8])[*:9].[CH3:4][CH3:6]'
    SMARTS[1][162]='[CH2:1]([*:3])[CH3:2].([CH2:4]=[*:5].[CH:6]([*:7])([*:8])[*:9])>>[C:1]([*:3])(=[*:5])[C:2]([*:7])([*:8])[*:9].[CH3:4][CH3:6]'
    SMARTS[1][163]='[CH2:1]([*:3])[CH3:2].([CH2:4]([*:5])[*:6].[CH2:7]([*:8])[*:9])>>[C:1]([*:3])([*:5])([*:6])[CH:2]([*:8])[*:9].[CH3:4][CH3:7]'
    SMARTS[1][164]='[CH2:1]([*:3])[CH3:2].([CH3:4][*:5].[CH2:6]([*:7])[*:8])>>[CH:1]([*:3])([*:5])[CH:2]([*:7])[*:8].[CH3:4][CH3:6]'
    SMARTS[1][165]='[CH2:1]([*:3])[CH3:2].([CH2:4]=[*:5].[CH2:6]([*:7])[*:8])>>[C:1]([*:3])(=[*:5])[CH:2]([*:7])[*:8].[CH3:4][CH3:6]'
    SMARTS[1][166]='[CH2:1]([*:3])[CH3:2].([CH2:4]([*:5])[*:6].[CH3:7][*:8])>>[C:1]([*:3])([*:5])([*:6])[CH2:2][*:8].[CH3:4][CH3:7]'
    SMARTS[1][167]='[CH2:1]([*:3])[CH3:2].([CH3:4][*:5].[CH3:6][*:7])>>[CH:1]([*:3])([*:5])[CH2:2][*:7].[CH3:4][CH3:6]'
    SMARTS[1][168]='[CH2:1]([*:3])[CH3:2].([CH2:4]=[*:5].[CH3:6][*:7])>>[C:1]([*:3])(=[*:5])[CH2:2][*:7].[CH3:4][CH3:6]'
    SMARTS[1][169]='[CH2:1]([*:3])[CH3:2].([CH2:4]([*:5])[*:6].[CH2:7]=[*:8])>>[C:1]([*:3])([*:5])([*:6])[CH:2]=[*:8].[CH3:4][CH3:7]'
    SMARTS[1][170]='[CH2:1]([*:3])[CH3:2].([CH3:4][*:5].[CH2:6]=[*:7])>>[CH:1]([*:3])([*:5])[CH:2]=[*:7].[CH3:4][CH3:6]'
    SMARTS[1][171]='[CH2:1]([*:3])[CH3:2].([CH2:4]=[*:5].[CH2:6]=[*:7])>>[C:1]([*:3])(=[*:5])[CH:2]=[*:7].[CH3:4][CH3:6]'
    SMARTS[1][172]='[CH2:1]([*:3])[CH3:2].([CH2:4]([*:5])[*:6].[CH:7]#[*:8])>>[C:1]([*:3])([*:5])([*:6])[C:2]#[*:8].[CH3:4][CH3:7]'
    SMARTS[1][173]='[CH2:1]([*:3])[CH3:2].([CH3:4][*:5].[CH:6]#[*:7])>>[CH:1]([*:3])([*:5])[C:2]#[*:7].[CH3:4][CH3:6]'
    SMARTS[1][174]='[CH2:1]([*:3])[CH3:2].([CH2:4]=[*:5].[CH:6]#[*:7])>>[C:1]([*:3])(=[*:5])[C:2]#[*:7].[CH3:4][CH3:6]'
    SMARTS[1][175]='[CH2:1]([*:3])[CH3:2].([CH2:4]([*:5])[*:6].[CH:7](=[*:8])[*:9])>>[C:1]([*:3])([*:5])([*:6])[C:2](=[*:8])[*:9].[CH3:4][CH3:7]'
    SMARTS[1][176]='[CH2:1]([*:3])[CH3:2].([CH3:4][*:5].[CH:6](=[*:7])[*:8])>>[CH:1]([*:3])([*:5])[C:2](=[*:7])[*:8].[CH3:4][CH3:6]'
    SMARTS[1][177]='[CH2:1]([*:3])[CH3:2].([CH2:4]=[*:5].[CH:6](=[*:7])[*:8])>>[C:1]([*:3])(=[*:5])[C:2](=[*:7])[*:8].[CH3:4][CH3:6]'

    SMARTS[1][178]='[CH3:1][CH3:2].([CH:3]([*:4])([*:5])[*:6].[CH:7]([*:8])([*:9])[*:10])>>[C:1]([*:4])([*:5])([*:6])[C:2]([*:8])([*:9])[*:10].[CH3:3][CH3:7]'
    SMARTS[1][179]='[CH3:1][CH3:2].([CH2:3]([*:4])[*:5].[CH:6]([*:7])([*:8])[*:9])>>[CH:1]([*:4])([*:5])[C:2]([*:7])([*:8])[*:9].[CH3:3][CH3:6]'
    SMARTS[1][180]='[CH3:1][CH3:2].([CH3:3][*:4].[CH:5]([*:6])([*:7])[*:8])>>[CH2:1]([*:4])[C:2]([*:6])([*:7])[*:8].[CH3:3][CH3:5]'
    SMARTS[1][181]='[CH3:1][CH3:2].([CH:3](=[*:4])[*:5].[CH:6]([*:7])([*:8])[*:9])>>[C:1](=[*:4])([*:5])[C:2]([*:7])([*:8])[*:9].[CH3:3][CH3:6]'
    SMARTS[1][182]='[CH3:1][CH3:2].([CH2:3]=[*:4].[CH:5]([*:6])([*:7])[*:8])>>[CH:1](=[*:4])[C:2]([*:6])([*:7])[*:8].[CH3:3][CH3:5]'
    SMARTS[1][183]='[CH3:1][CH3:2].([CH:3]#[*:4].[CH:5]([*:6])([*:7])[*:8])>>[C:1](#[*:4])[C:2]([*:6])([*:7])[*:8].[CH3:3][CH3:5]'
    SMARTS[1][184]='[CH3:1][CH3:2].([CH2:3]([*:4])[*:5].[CH2:6]([*:7])[*:8])>>[CH:1]([*:4])([*:5])[CH:2]([*:7])[*:8].[CH3:3][CH3:6]'
    SMARTS[1][185]='[CH3:1][CH3:2].([CH3:3][*:4].[CH2:5]([*:6])[*:7])>>[CH2:1]([*:4])[CH:2]([*:6])[*:7].[CH3:3][CH3:5]'
    SMARTS[1][186]='[CH3:1][CH3:2].([CH:3](=[*:4])[*:5].[CH2:6]([*:7])[*:8])>>[C:1](=[*:4])([*:5])[CH:2]([*:7])[*:8].[CH3:3][CH3:6]'
    SMARTS[1][187]='[CH3:1][CH3:2].([CH2:3]=[*:4].[CH2:5]([*:6])[*:7])>>[CH:1](=[*:4])[CH:2]([*:6])[*:7].[CH3:3][CH3:5]'
    SMARTS[1][188]='[CH3:1][CH3:2].([CH:3]#[*:4].[CH2:5]([*:6])[*:7])>>[C:1](#[*:4])[CH:2]([*:6])[*:7].[CH3:3][CH3:5]'
    SMARTS[1][189]='[CH3:1][CH3:2].([CH3:3][*:4].[CH3:5][*:6])>>[CH2:1]([*:4])[CH2:2]([*:6]).[CH3:3][CH3:5]'
    SMARTS[1][190]='[CH3:1][CH3:2].([CH:3](=[*:4])[*:5].[CH3:6][*:7])>>[C:1](=[*:4])([*:5])[CH2:2][*:7].[CH3:3][CH3:6]'
    SMARTS[1][191]='[CH3:1][CH3:2].([CH2:3]=[*:4].[CH3:5][*:6])>>[CH:1](=[*:4])[CH2:2]([*:6]).[CH3:3][CH3:5]'
    SMARTS[1][192]='[CH3:1][CH3:2].([CH:3]#[*:4].[CH3:5][*:6])>>[C:1](#[*:4])[CH2:2]([*:6]).[CH3:3][CH3:5]'
    SMARTS[1][193]='[CH3:1][CH3:2].([CH:3](=[*:4])[*:5].[CH:6](=[*:7])[*:8])>>[C:1](=[*:4])([*:5])[C:2](=[*:7])[*:8].[CH3:3][CH3:6]'
    SMARTS[1][194]='[CH3:1][CH3:2].([CH2:3]=[*:4].[CH:5](=[*:6])[*:7])>>[CH:1](=[*:4])[C:2](=[*:6])[*:7].[CH3:3][CH3:5]'
    SMARTS[1][195]='[CH3:1][CH3:2].([CH:3]#[*:4].[CH:5](=[*:6])[*:7])>>[C:1](#[*:4])[C:2](=[*:6])[*:7].[CH3:3][CH3:5]'
    SMARTS[1][196]='[CH3:1][CH3:2].([CH2:3]=[*:4].[CH2:5]=[*:6])>>[CH:1](=[*:4])[CH:2](=[*:6]).[CH3:3][CH3:5]'
    SMARTS[1][197]='[CH3:1][CH3:2].([CH:3]#[*:4].[CH2:5]=[*:6])>>[C:1](#[*:4])[CH:2](=[*:6]).[CH3:3][CH3:5]'
    SMARTS[1][198]='[CH3:1][CH3:2].([CH:3]#[*:4].[CH:5]#[*:6])>>[C:1](#[*:4])[C:2](#[*:6]).[CH3:3][CH3:5]'

    SMARTS[1][199]='[CH:1]([*:3])=[CH:2]([*:4]).([CH3:5][*:6].[CH3:7][*:8])>>[C:1]([*:3])([*:6])=[C:2]([*:4])[*:8].[CH3:5][CH3:7]'
    SMARTS[1][200]='[CH2:1]=[CH:2][*:3].([CH2:4]([*:5])[*:6].[CH3:7][*:8])>>[C:1]([*:5])([*:6])=[C:2]([*:3])[*:8].[CH3:4][CH3:7]'
    SMARTS[1][201]='[CH:1]([*:3])=[CH2:2].([CH3:4][*:5].[CH3:6][*:7])>>[C:1]([*:3])([*:5])=[CH:2][*:7].[CH3:4][CH3:6]'
    SMARTS[1][202]='[CH:1]([*:3])=[CH2:2].([CH3:4][*:5].[CH2:6]=[*:7])>>[C:1]([*:3])([*:5])=[C:2]=[*:7].[CH3:4][CH3:6]'
    SMARTS[1][203]='[CH2:1]=[CH2:2].([CH2:3]([*:4])[*:5].[CH2:6]([*:7])[*:8])>>[C:1]([*:4])([*:5])=[C:2]([*:7])[*:8].[CH3:3][CH3:6]'
    SMARTS[1][204]='[CH2:1]=[CH2:2].([CH3:3][*:4].[CH2:5]([*:6])[*:7])>>[CH:1]([*:4])=[C:2]([*:6])[*:7].[CH3:3][CH3:5]'
    SMARTS[1][205]='[CH2:1]=[CH2:2].([CH2:3]=[*:4].[CH2:5]([*:6])[*:7])>>[C:1](=[*:4])=[C:2]([*:6])[*:7].[CH3:3][CH3:5]'
    SMARTS[1][206]='[CH2:1]=[CH2:2].([CH3:3][*:4].[CH3:5][*:6])>>[CH:1]([*:4])=[CH:2][*:6].[CH3:3][CH3:5]'
    SMARTS[1][207]='[CH2:1]=[CH2:2].([CH2:3]=[*:4].[CH3:5][*:6])>>[C:1](=[*:4])=[CH:2][*:6].[CH3:3][CH3:5]'
    SMARTS[1][208]='[CH2:1]=[CH2:2].([CH2:3]=[*:4].[CH2:5]=[*:6])>>[C:1](=[*:4])=[C:2]=[*:6].[CH3:3][CH3:5]'
    SMARTS[1][209]='[CH:1]#[CH:2].([CH3:3][*:4].[CH3:5][*:6])>>[C:1]([*:4])#[C:2][*:6].[CH3:3][CH3:5]'

    SMARTS[1][210]='[CH:1](=[*:3])[CH:2]([*:4])[*:5].([CH3:6][*:7].[CH3:8][*:9])>>[C:1](=[*:3])([*:7])[C:2]([*:4])([*:5])[*:9].[CH3:6][CH3:8]'
    SMARTS[1][211]='[CH:1](=[*:3])[CH2:2][*:4].([CH2:5]([*:6])[*:7].[CH3:8][*:9])>>[C:1](=[*:3])([*:9])[C:2]([*:4])([*:6])[*:7].[CH3:5][CH3:8]'
    SMARTS[1][212]='[CH:1](=[*:3])[CH2:2][*:4].([CH3:5][*:6].[CH3:7][*:8])>>[C:1](=[*:3])([*:6])[CH:2]([*:4])[*:8].[CH3:5][CH3:7]'
    SMARTS[1][213]='[CH:1](=[*:3])[CH:2]=[*:4].([CH3:5][*:6].[CH3:7][*:8])>>[C:1](=[*:3])([*:6])[C:2](=[*:4])[*:8].[CH3:5][CH3:7]'
    SMARTS[1][214]='[CH:1](=[*:3])[CH3:2].([CH2:4]([*:5])[*:6].[CH3:7][*:8])>>[C:1](=[*:3])([*:8])[CH:2]([*:5])[*:6].[CH3:4][CH3:7]'
    SMARTS[1][215]='[CH:1](=[*:3])[CH3:2].([CH3:4][*:5].[CH3:6][*:7])>>[C:1](=[*:3])([*:5])[CH2:2][*:7].[CH3:4][CH3:6]'
    SMARTS[1][215]='[CH:1](=[*:3])[CH3:2].([CH3:4][*:5].[CH2:6]=[*:7])>>[C:1](=[*:3])([*:5])[CH:2]=[*:7].[CH3:4][CH3:6]'

    SMARTS[1][216]='[NH:1]([*:3])[NH:2][*:4].([NH2:5][*:6].[NH2:7][*:8])>>[N:1]([*:3])([*:6])[N:2]([*:4])[*:8].[NH2:5][NH2:7]'
    SMARTS[1][217]='[NH:1]([*:3])[NH2:2].([NH2:4][*:5].[NH:6]([*:7])[*:8])>>[N:1]([*:3])([*:5])[N:2]([*:7])[*:8].[NH2:4][NH2:6]'
    SMARTS[1][218]='[NH:1]([*:3])[NH2:2].([NH2:4][*:5].[NH2:6][*:7])>>[N:1]([*:3])([*:5])[NH:2][*:7].[NH2:4][NH2:6]'
    SMARTS[1][219]='[NH:1]([*:3])[NH2:2].([NH2:4][*:5].[NH:6]=[*:7])>>[N:1]([*:3])([*:5])[N:2]=[*:7].[NH2:4][NH2:6]'
    SMARTS[1][220]='[NH2:1][NH2:2].([NH:3]([*:4])[*:5].[NH:6]([*:7])[*:8])>>[N:1]([*:4])([*:5])[N:2]([*:7])[*:8].[NH2:3][NH2:6]'
    SMARTS[1][221]='[NH2:1][NH2:2].([NH:3]([*:4])[*:5].[NH2:6][*:7])>>[N:1]([*:4])([*:5])[NH:2][*:7].[NH2:3][NH2:6]'
    SMARTS[1][222]='[NH2:1][NH2:2].([NH:3]([*:4])[*:5].[NH:6]=[*:7])>>[N:1]([*:4])([*:5])[N:2]=[*:7].[NH2:3][NH2:6]'
    SMARTS[1][223]='[NH2:1][NH2:2].([NH2:3][*:4].[NH2:5][*:6])>>[NH:1]([*:4])[NH:2][*:6].[NH2:3][NH2:5]'
    SMARTS[1][224]='[NH2:1][NH2:2].([NH:3]=[*:4].[NH2:5][*:6])>>[N:1](=[*:4])[NH:2][*:6].[NH2:3][NH2:5]'
    SMARTS[1][225]='[NH2:1][NH2:2].([NH:3]=[*:4].[NH:5]=[*:6])>>[N:1](=[*:4])[N:2]=[*:6].[NH2:3][NH2:5]'

    SMARTS[1][226]='[OH:1][OH:2].([OH:3][*:4].[OH:5][*:6])>>[O:1]([*:4])[O:2][*:6].[OH:3][OH:5]'

    SMARTS[1][227]='[CH:1]([*:3])([*:4])[NH:2][*:5].([CH3:6][*:7].[NH2:8][*:9])>>[C:1]([*:3])([*:4])([*:7])[N:2]([*:5])[*:9].[CH3:6][NH2:8]'
    SMARTS[1][228]='[CH2:1]([*:3])[NH:2][*:4].([CH2:5]([*:6])[*:7].[CH3:8][*:9])>>[C:1]([*:3])([*:6])([*:7])[N:2]([*:4])[*:9].[CH3:5][CH3:8]'
    SMARTS[1][229]='[CH2:1]([*:3])[NH:2][*:4].([CH3:5][*:6].[NH2:7][*:8])>>[CH:1]([*:3])([*:6])[N:2]([*:4])[*:8].[CH3:5][NH2:7]'
    SMARTS[1][230]='[CH2:1]([*:3])[NH:2][*:4].([CH2:5]=[*:6].[NH2:7][*:8])>>[C:1]([*:3])(=[*:6])[N:2]([*:4])[*:8].[CH3:5][NH2:7]'
    SMARTS[1][231]='[CH:1](=[*:3])[NH:2][*:4].([CH3:5][*:6].[NH2:7][*:8])>>[C:1](=[*:3])([*:6])[N:2]([*:4])[*:8].[CH3:5][NH2:7]'
    SMARTS[1][232]='[CH3:1][NH:2][*:3].([CH:5]([*:6])([*:7])[*:8].[CH3:9][*:10])>>[C:1]([*:6])([*:7])([*:8])[N:2]([*:3])[*:10].[CH3:5][NH2:9]'
    SMARTS[1][233]='[CH3:1][NH:2][*:3].([CH2:4]([*:5])[*:6].[NH2:7][*:8])>>[CH:1]([*:5])([*:6])[N:2]([*:3])[*:8].[CH3:4][NH2:7]'
    SMARTS[1][234]='[CH3:1][NH:2][*:3].([CH3:4][*:5].[NH2:6][*:7])>>[CH2:1]([*:5])[N:2]([*:3])[*:7].[CH3:4][NH2:6]'
    SMARTS[1][235]='[CH3:1][NH:2][*:3].([CH2:4]=[*:5].[NH2:6][*:7])>>[CH:1](=[*:5])[N:2]([*:3])[*:7].[CH3:4][NH2:6]'
    SMARTS[1][236]='[CH3:1][NH:2][*:3].([CH2:4]=[*:5].[NH2:6][*:7])>>[CH:1](=[*:5])[N:2]([*:3])[*:7].[CH3:4][NH2:6]'
    SMARTS[1][237]='[CH3:1][NH:2][*:3].([CH:4]#[*:5].[NH2:6][*:7])>>[C:1](#[*:5])[N:2]([*:3])[*:7].[CH3:4][NH2:6]'
    SMARTS[1][238]='[CH:1]([*:3])([*:4])[NH2:2].([CH3:5][*:6].[NH2:7][*:8])>>[C:1]([*:3])([*:4])([*:6])[NH:2][*:8].[CH3:5][NH2:7]'
    SMARTS[1][239]='[CH:1]([*:3])([*:4])[NH2:2].([CH3:5][*:6].[NH:7]=[*:8])>>[C:1]([*:3])([*:4])([*:6])[N:2]=[*:8].[CH3:5][NH2:7]'
    SMARTS[1][240]='[CH2:1]([*:3])[NH2:2].([CH2:4]([*:5])[*:6].[NH:7]([*:8])[*:9])>>[C:1]([*:3])([*:5])([*:6])[N:2]([*:8])[*:9].[CH3:4][NH2:7]'
    SMARTS[1][241]='[CH2:1]([*:3])[NH2:2].([CH3:4][*:5].[NH:6]([*:7])[*:8])>>[CH:1]([*:3])([*:5])[N:2]([*:7])[*:8].[CH3:4][NH2:6]'
    SMARTS[1][242]='[CH2:1]([*:3])[NH2:2].([CH2:4]=[*:5].[NH:6]([*:7])[*:8])>>[C:1]([*:3])(=[*:5])[N:2]([*:7])[*:8].[CH3:4][NH2:6]'
    SMARTS[1][243]='[CH2:1]([*:3])[NH2:2].([CH2:4]([*:5])[*:6].[NH2:7][*:8])>>[C:1]([*:3])([*:5])([*:6])[NH:2][*:8].[CH3:4][NH2:7]'
    SMARTS[1][244]='[CH2:1]([*:3])[NH2:2].([CH2:4]([*:5])[*:6].[NH2:7][*:8])>>[C:1]([*:3])([*:5])([*:6])[NH:2][*:8].[CH3:4][NH2:7]'
    SMARTS[1][245]='[CH2:1]([*:3])[NH2:2].([CH3:4][*:5].[NH2:6][*:7])>>[CH:1]([*:3])([*:5])[NH:2][*:7].[CH3:4][NH2:6]'
    SMARTS[1][246]='[CH2:1]([*:3])[NH2:2].([CH2:4]=[*:5].[NH2:6][*:7])>>[C:1]([*:3])(=[*:5])[NH:2][*:7].[CH3:4][NH2:6]'
    SMARTS[1][247]='[CH2:1]([*:3])[NH2:2].([CH2:4]([*:5])[*:6].[NH:7]=[*:8])>>[C:1]([*:3])([*:5])([*:6])[N:2]=[*:8].[CH3:4][NH2:7]'
    SMARTS[1][248]='[CH2:1]([*:3])[NH2:2].([CH3:4][*:5].[NH:6]=[*:7])>>[CH:1]([*:3])([*:5])[N:2]=[*:7].[CH3:4][NH2:6]'
    SMARTS[1][249]='[CH2:1]([*:3])[NH2:2].([CH2:4]=[*:5].[NH:6]=[*:7])>>[C:1]([*:3])(=[*:5])[N:2]=[*:7].[CH3:4][NH2:6]'
    SMARTS[1][250]='[CH:1](=[*:3])[NH2:2].([CH3:4][*:5].[NH2:6][*:7])>>[C:1](=[*:3])([*:5])[NH:2][*:7].[CH3:4][NH2:6]'

    SMARTS[1][251]='[CH3:1][NH2:2].([CH:3]([*:4])([*:5])[*:6].[NH:7]([*:8])[*:9])>>[C:3]([*:4])([*:5])([*:6])[N:2]([*:8])[*:9].[CH3:3][NH2:7]'
    SMARTS[1][252]='[CH3:1][NH2:2].([CH2:3]([*:4])[*:5].[NH:6]([*:7])[*:8])>>[CH:1]([*:4])([*:5])[N:2]([*:7])[*:8].[CH3:3][NH2:6]'
    SMARTS[1][253]='[CH3:1][NH2:2].([CH3:3][*:4].[NH:5]([*:6])[*:7])>>[CH2:1]([*:4])[N:2]([*:6])[*:7].[CH3:3][NH2:5]'
    SMARTS[1][254]='[CH3:1][NH2:2].([CH:3](=[*:4])[*:5].[NH:6]([*:7])[*:8])>>[C:1](=[*:4])([*:5])[N:2]([*:7])[*:8].[CH3:3][NH2:6]'
    SMARTS[1][255]='[CH3:1][NH2:2].([CH2:3]=[*:4].[NH:5]([*:6])[*:7])>>[CH:1](=[*:4])[N:2]([*:6])[*:7].[CH3:3][NH2:5]'
    SMARTS[1][256]='[CH3:1][NH2:2].([CH:3]#[*:4].[NH:5]([*:6])[*:7])>>[C:1](#[*:4])[N:2]([*:6])[*:7].[CH3:3][NH2:5]'
    SMARTS[1][257]='[CH3:1][NH2:2].([CH:3]([*:4])([*:5])[*:6].[NH2:7][*:8])>>[C:1]([*:4])([*:5])([*:6])[NH:2][*:8].[CH3:3][NH2:7]'
    SMARTS[1][258]='[CH3:1][NH2:2].([CH2:3]([*:4])[*:5].[NH2:6][*:7])>>[CH:1]([*:4])([*:5])[NH:2][*:7].[CH3:3][NH2:6]'
    SMARTS[1][259]='[CH3:1][NH2:2].([CH3:3][*:4].[NH2:5][*:6])>>[CH2:1]([*:4])[NH:2][*:6].[NH2:5][CH3:3]'
    SMARTS[1][260]='[CH3:1][NH2:2].([CH:3](=[*:4])[*:5].[NH2:6][*:7])>>[C:1](=[*:4])([*:5])[NH:2][*:7].[CH3:3][NH2:6]'
    SMARTS[1][261]='[CH3:1][NH2:2].([CH2:3]=[*:4].[NH2:5][*:6])>>[CH:1](=[*:4])[NH:2][*:6].[NH2:5][CH3:3]'
    SMARTS[1][262]='[CH3:1][NH2:2].([CH:3]#[*:4].[NH2:5][*:6])>>[C:1](#[*:4])[NH:2][*:6].[NH2:5][CH3:3]'
    SMARTS[1][263]='[CH3:1][NH2:2].([CH:3]([*:4])([*:5])[*:6].[NH:7]=[*:8])>>[C:1]([*:4])([*:5])([*:6])[N:2]=[*:8].[CH3:3][NH2:7]'
    SMARTS[1][264]='[CH3:1][NH2:2].([CH2:3]([*:4])[*:5].[NH:6]=[*:7])>>[CH:1]([*:4])([*:5])[N:2]=[*:7].[CH3:3][NH2:6]'
    SMARTS[1][265]='[CH3:1][NH2:2].([CH3:3][*:4].[NH:5]=[*:6])>>[CH2:1]([*:4])[N:2]=[*:6].[NH2:5][CH3:3]'
    SMARTS[1][266]='[CH3:1][NH2:2].([CH:3](=[*:4])[*:5].[NH:6]=[*:7])>>[C:1](=[*:4])([*:5])[N:2]=[*:7].[CH3:3][NH2:6]'
    SMARTS[1][267]='[CH3:1][NH2:2].([CH2:3]=[*:4].[NH:5]=[*:6])>>[CH:1](=[*:4])[N:2]=[*:6].[NH2:5][CH3:3]'
    SMARTS[1][268]='[CH3:1][NH2:2].([CH:3]#[*:4].[NH:5]=[*:6])>>[C:1](#[*:4])[N:2]=[*:6].[NH2:5][CH3:3]'

    SMARTS[1][269]='[CH:1]([*:3])=[NH:2].([CH3:4][*:5].[NH2:6][*:7])>>[C:1]([*:3])([*:5])=[N:2][*:7].[CH3:4][NH2:6]'
    SMARTS[1][270]='[CH2:1]=[NH:2].([CH2:3]([*:4])[*:5].[NH2:6][*:7])>>[C:1]([*:4])([*:5])=[N:2][*:7].[CH3:3][NH2:6]'
    SMARTS[1][271]='[CH2:1]=[NH:2].([CH3:3][*:4].[NH2:5][*:6])>>[CH:1]([*:4])=[N:2][*:6].[CH3:3][NH2:5]'
    SMARTS[1][272]='[CH2:1]=[NH:2].([CH2:3]=[*:4].[NH2:5][*:6])>>[C:1](=[*:4])=[N:2][*:6].[CH3:3][NH2:5]'

    SMARTS[1][273]='[CH:1]([*:3])([*:4])[OH:2].([CH3:5][*:6].[OH:7][*:8])>>[C:1]([*:3])([*:4])([*:6])[O:2][*:8].[CH3:5][OH:7]'
    SMARTS[1][274]='[CH2:1]([*:3])[OH:2].([CH2:4]([*:5])[*:6].[OH:7][*:8])>>[C:1]([*:3])([*:5])([*:6])[O:2][*:8].[CH3:4][OH:7]'
    SMARTS[1][275]='[CH2:1]([*:3])[OH:2].([CH3:4][*:5].[OH:6][*:7])>>[CH:1]([*:3])([*:5])[O:2][*:7].[CH3:4][OH:6]'
    SMARTS[1][276]='[CH2:1]([*:3])[OH:2].([CH2:4]=[*:5].[OH:6][*:7])>>[C:1]([*:3])(=[*:5])[O:2][*:7].[CH3:4][OH:6]'

    SMARTS[1][277]='[CH3:1][OH:2].([CH:3]([*:4])([*:5])[*:6].[OH:7][*:8])>>[C:1]([*:4])([*:5])([*:6])[O:2][*:8].[CH3:3][OH:7]'
    SMARTS[1][278]='[CH3:1][OH:2].([CH2:3]([*:4])[*:5].[OH:6][*:7])>>[CH:1]([*:4])([*:5])[O:2][*:7].[CH3:3][OH:6]'
    SMARTS[1][279]='[CH3:1][OH:2].([CH3:3][*:4].[OH:5][*:6])>>[CH2:1]([*:4])[O:2][*:6].[CH3:3][OH:5]'
    SMARTS[1][280]='[CH3:1][OH:2].([CH:3](=[*:4])[*:5].[OH:6][*:7])>>[C:1](=[*:4])([*:5])[O:2][*:7].[CH3:3][OH:6]'
    SMARTS[1][281]='[CH3:1][OH:2].([CH2:3]=[*:4].[OH:5][*:6])>>[CH:1](=[*:4])[O:2][*:6].[CH3:3][OH:5]'
    SMARTS[1][282]='[CH3:1][OH:2].([CH:3]#[*:4].[OH:5][*:6])>>[C:1](#[*:4])[O:2][*:6].[CH3:3][OH:5]'
    SMARTS[1][283]='[CH:1](=[*:3])[OH:2].([CH3:4][*:5].[OH:6][*:7])>>[C:1](=[*:3])([*:5])[O:2][*:7].[CH3:4][OH:6]'

    SMARTS[1][284]='[NH:1]([*:3])[OH:2].([NH2:4][*:5].[OH:6][*:7])>>[N:1]([*:3])([*:5])[O:2][*:7].[NH2:4][OH:6]'
    SMARTS[1][285]='[NH2:1][OH:2].([NH:3]([*:4])[*:5].[OH:6][*:7])>>[N:1]([*:4])([*:5])[O:2][*:7].[NH2:3][OH:6]'
    SMARTS[1][286]='[NH2:1][OH:2].([NH2:3][*:4].[OH:5][*:6])>>[NH:1]([*:4])[O:2][*:6].[NH2:3][OH:5]'
    SMARTS[1][287]='[NH2:1][OH:2].([NH:3]=[*:4].[OH:5][*:6])>>[N:1](=[*:4])[O:2][*:6].[NH2:3][OH:5]'

    SMARTS[1][288]='[CH:1]([*:3])([*:4])[*:99][CH:2]([*:5])[*:6].([CH3:7][*:8].[CH3:9][*:10])>>[C:1]([*:3])([*:4])([*:8])[*:99][C:2]([*:5])([*:6])[*:10].[CH3:7][CH3:9]'
    SMARTS[1][289]='[CH:1]([*:3])([*:4])[*:99][CH2:2][*:5].([CH3:6][*:7].[CH2:8]([*:9])[*:10])>>[C:1]([*:3])([*:4])([*:7])[*:99][C:2]([*:5])([*:9])[*:10].[CH3:6][CH3:8]'
    SMARTS[1][290]='[CH:1]([*:3])([*:4])[*:99][CH2:2][*:5].([CH3:6][*:7].[CH2:8][*:9])>>[C:1]([*:3])([*:4])([*:7])[*:99][CH:2]([*:5])[*:9].[CH3:6][CH3:8]'
    SMARTS[1][291]='[CH:1]([*:3])([*:4])[*:99][CH2:2][*:5].([CH3:6][*:7].[CH2:8]=[*:9])>>[C:1]([*:3])([*:4])([*:7])[*:99][C:2]([*:5])=[*:9].[CH3:6][CH3:8]'
    SMARTS[1][292]='[CH2:1]([*:3])[CH2:2][*:4].([CH2:5]([*:6])[*:7].[CH2:8]([*:9])[*:10])>>[C:1]([*:3])([*:6])([*:7])[C:2]([*:4])([*:9])[*:10].[CH3:5][CH3:8]'
    SMARTS[1][293]='[CH2:1]([*:3])[*:99][CH2:2][*:4].([CH2:5]([*:6])[*:7].[CH3:8][*:9])>>[C:1]([*:3])([*:6])([*:7])[*:99][CH:2]([*:4])[*:9].[CH3:5][CH3:8]'
    SMARTS[1][294]='[CH2:1]([*:3])[*:99][CH2:2][*:4].([CH2:5]([*:6])[*:7].[CH2:8]=[*:9])>>[C:1]([*:3])([*:6])([*:7])[*:99][C:2]([*:4])=[*:9].[CH3:5][CH3:8]'
    SMARTS[1][295]='[CH2:1]([*:3])[*:99][CH2:2][*:4].([CH3:5][*:6].[CH3:7][*:8])>>[CH:1]([*:3])([*:6])[*:99][CH:2]([*:4])[*:8].[CH3:5][CH3:7]'
    SMARTS[1][296]='[CH2:1]([*:3])[*:99][CH2:2][*:4].([CH3:5][*:6].[CH2:7]=[*:8])>>[CH:1]([*:3])([*:6])[*:99][C:2]([*:4])=[*:8].[CH3:5][CH3:7]'
    SMARTS[1][297]='[CH2:1]([*:3])[*:99][CH2:2][*:4].([CH2:5]=[*:6].[CH2:7]=[*:8])>>[C:1]([*:3])(=[*:6])[*:99][C:2]([*:4])=[*:8].[CH3:5][CH3:7]'
    SMARTS[1][298]='[CH2:1]([*:3])[*:99][CH3:2].([CH2:4]([*:5])[*:6].[CH:7]([*:8])([*:9])[*:10])>>[C:1]([*:3])([*:5])([*:6])[*:99][C:2]([*:8])([*:9])[*:10].[CH3:4][CH3:7]'
    SMARTS[1][299]='[CH2:1]([*:3])[*:99][CH3:2].([CH3:4][*:5].[CH:6]([*:7])([*:8])[*:9])>>[CH:1]([*:3])([*:5])[*:99][C:2]([*:7])([*:8])[*:9].[CH3:4][CH3:6]'
    SMARTS[1][300]='[CH2:1]([*:3])[*:99][CH3:2].([CH2:4]=[*:5].[CH:6]([*:7])([*:8])[*:9])>>[C:1]([*:3])(=[*:5])[*:99][C:2]([*:7])([*:8])[*:9].[CH3:4][CH3:6]'
    SMARTS[1][301]='[CH2:1]([*:3])[*:99][CH3:2].([CH2:4]([*:5])[*:6].[CH2:7]([*:8])[*:9])>>[C:1]([*:3])([*:5])([*:6])[*:99][CH:2]([*:8])[*:9].[CH3:4][CH3:7]'
    SMARTS[1][302]='[CH2:1]([*:3])[*:99][CH3:2].([CH3:4][*:5].[CH2:6]([*:7])[*:8])>>[CH:1]([*:3])([*:5])[*:99][CH:2]([*:7])[*:8].[CH3:4][CH3:6]'
    SMARTS[1][303]='[CH2:1]([*:3])[*:99][CH3:2].([CH2:4]=[*:5].[CH2:6]([*:7])[*:8])>>[C:1]([*:3])(=[*:5])[*:99][CH:2]([*:7])[*:8].[CH3:4][CH3:6]'
    SMARTS[1][304]='[CH2:1]([*:3])[*:99][CH3:2].([CH2:4]([*:5])[*:6].[CH3:7][*:8])>>[C:1]([*:3])([*:5])([*:6])[*:99][CH2:2][*:8].[CH3:4][CH3:7]'
    SMARTS[1][305]='[CH2:1]([*:3])[*:99][CH3:2].([CH3:4][*:5].[CH3:6][*:7])>>[CH:1]([*:3])([*:5])[*:99][CH2:2][*:7].[CH3:4][CH3:6]'
    SMARTS[1][306]='[CH2:1]([*:3])[*:99][CH3:2].([CH2:4]=[*:5].[CH3:6][*:7])>>[C:1]([*:3])(=[*:5])[*:99][CH2:2][*:7].[CH3:4][CH3:6]'
    SMARTS[1][307]='[CH2:1]([*:3])[*:99][CH3:2].([CH2:4]([*:5])[*:6].[CH2:7]=[*:8])>>[C:1]([*:3])([*:5])([*:6])[*:99][CH:2]=[*:8].[CH3:4][CH3:7]'
    SMARTS[1][308]='[CH2:1]([*:3])[*:99][CH3:2].([CH3:4][*:5].[CH2:6]=[*:7])>>[CH:1]([*:3])([*:5])[*:99][CH:2]=[*:7].[CH3:4][CH3:6]'
    SMARTS[1][309]='[CH2:1]([*:3])[*:99][CH3:2].([CH2:4]=[*:5].[CH2:6]=[*:7])>>[C:1]([*:3])(=[*:5])[*:99][CH:2]=[*:7].[CH3:4][CH3:6]'
    SMARTS[1][310]='[CH2:1]([*:3])[*:99][CH3:2].([CH2:4]([*:5])[*:6].[CH:7]#[*:8])>>[C:1]([*:3])([*:5])([*:6])[*:99][C:2]#[*:8].[CH3:4][CH3:7]'
    SMARTS[1][311]='[CH2:1]([*:3])[*:99][CH3:2].([CH3:4][*:5].[CH:6]#[*:7])>>[CH:1]([*:3])([*:5])[*:99][C:2]#[*:7].[CH3:4][CH3:6]'
    SMARTS[1][312]='[CH2:1]([*:3])[*:99][CH3:2].([CH2:4]=[*:5].[CH:6]#[*:7])>>[C:1]([*:3])(=[*:5])[*:99][C:2]#[*:7].[CH3:4][CH3:6]'
    SMARTS[1][313]='[CH2:1]([*:3])[*:99][CH3:2].([CH2:4]([*:5])[*:6].[CH:7](=[*:8])[*:9])>>[C:1]([*:3])([*:5])([*:6])[*:99][C:2](=[*:8])[*:9].[CH3:4][CH3:7]'
    SMARTS[1][314]='[CH2:1]([*:3])[*:99][CH3:2].([CH3:4][*:5].[CH:6](=[*:7])[*:8])>>[CH:1]([*:3])([*:5])[*:99][C:2](=[*:7])[*:8].[CH3:4][CH3:6]'
    SMARTS[1][315]='[CH2:1]([*:3])[*:99][CH3:2].([CH2:4]=[*:5].[CH:6](=[*:7])[*:8])>>[C:1]([*:3])(=[*:5])[*:99][C:2](=[*:7])[*:8].[CH3:4][CH3:6]'
    SMARTS[1][316]='[CH3:1][*:99][CH3:2].([CH:3]([*:4])([*:5])[*:6].[CH:7]([*:8])([*:9])[*:10])>>[C:1]([*:4])([*:5])([*:6])[*:99][C:2]([*:8])([*:9])[*:10].[CH3:3][CH3:7]'
    SMARTS[1][317]='[CH3:1][*:99][CH3:2].([CH2:3]([*:4])[*:5].[CH:6]([*:7])([*:8])[*:9])>>[CH:1]([*:4])([*:5])[*:99][C:2]([*:7])([*:8])[*:9].[CH3:3][CH3:6]'
    SMARTS[1][318]='[CH3:1][*:99][CH3:2].([CH3:3][*:4].[CH:5]([*:6])([*:7])[*:8])>>[CH2:1]([*:4])[*:99][C:2]([*:6])([*:7])[*:8].[CH3:3][CH3:5]'
    SMARTS[1][319]='[CH3:1][*:99][CH3:2].([CH:3](=[*:4])[*:5].[CH:6]([*:7])([*:8])[*:9])>>[C:1](=[*:4])([*:5])[*:99][C:2]([*:7])([*:8])[*:9].[CH3:3][CH3:6]'
    SMARTS[1][320]='[CH3:1][*:99][CH3:2].([CH2:3]=[*:4].[CH:5]([*:6])([*:7])[*:8])>>[CH:1](=[*:4])[*:99][C:2]([*:6])([*:7])[*:8].[CH3:3][CH3:5]'
    SMARTS[1][321]='[CH3:1][*:99][CH3:2].([CH:3]#[*:4].[CH:5]([*:6])([*:7])[*:8])>>[C:1](#[*:4])[*:99][C:2]([*:6])([*:7])[*:8].[CH3:3][CH3:5]'
    SMARTS[1][322]='[CH3:1][*:99][CH3:2].([CH2:3]([*:4])[*:5].[CH2:6]([*:7])[*:8])>>[CH:1]([*:4])([*:5])[*:99][CH:2]([*:7])[*:8].[CH3:3][CH3:6]'
    SMARTS[1][323]='[CH3:1][*:99][CH3:2].([CH3:3][*:4].[CH2:5]([*:6])[*:7])>>[CH2:1]([*:4])[*:99][CH:2]([*:6])[*:7].[CH3:3][CH3:5]'
    SMARTS[1][324]='[CH3:1][*:99][CH3:2].([CH:3](=[*:4])[*:5].[CH2:6]([*:7])[*:8])>>[C:1](=[*:4])([*:5])[*:99][CH:2]([*:7])[*:8].[CH3:3][CH3:6]'
    SMARTS[1][325]='[CH3:1][*:99][CH3:2].([CH2:3]=[*:4].[CH2:5]([*:6])[*:7])>>[CH:1](=[*:4])[*:99][CH:2]([*:6])[*:7].[CH3:3][CH3:5]'
    SMARTS[1][326]='[CH3:1][*:99][CH3:2].([CH:3]#[*:4].[CH2:5]([*:6])[*:7])>>[C:1](#[*:4])[*:99][CH:2]([*:6])[*:7].[CH3:3][CH3:5]'
    SMARTS[1][327]='[CH3:1][*:99][CH3:2].([CH3:3][*:4].[CH3:5][*:6])>>[CH2:1]([*:4])[*:99][CH2:2]([*:6]).[CH3:3][CH3:5]'
    SMARTS[1][328]='[CH3:1][*:99][CH3:2].([CH:3](=[*:4])[*:5].[CH3:6][*:7])>>[C:1](=[*:4])([*:5])[*:99][CH2:2][*:7].[CH3:3][CH3:6]'
    SMARTS[1][329]='[CH3:1][*:99][CH3:2].([CH2:3]=[*:4].[CH3:5][*:6])>>[CH:1](=[*:4])[*:99][CH2:2]([*:6]).[CH3:3][CH3:5]'
    SMARTS[1][330]='[CH3:1][*:99][CH3:2].([CH:3]#[*:4].[CH3:5][*:6])>>[C:1](#[*:4])[*:99][CH2:2]([*:6]).[CH3:3][CH3:5]'
    SMARTS[1][331]='[CH3:1][*:99][CH3:2].([CH:3](=[*:4])[*:5].[CH:6](=[*:7])[*:8])>>[C:1](=[*:4])([*:5])[*:99][C:2](=[*:7])[*:8].[CH3:3][CH3:6]'
    SMARTS[1][332]='[CH3:1][*:99][CH3:2].([CH2:3]=[*:4].[CH:5](=[*:6])[*:7])>>[CH:1](=[*:4])[*:99][C:2](=[*:6])[*:7].[CH3:3][CH3:5]'
    SMARTS[1][333]='[CH3:1][*:99][CH3:2].([CH:3]#[*:4].[CH:5](=[*:6])[*:7])>>[C:1](#[*:4])[*:99][C:2](=[*:6])[*:7].[CH3:3][CH3:5]'
    SMARTS[1][334]='[CH3:1][*:99][CH3:2].([CH2:3]=[*:4].[CH2:5]=[*:6])>>[CH:1](=[*:4])[*:99][CH:2](=[*:6]).[CH3:3][CH3:5]'
    SMARTS[1][335]='[CH3:1][*:99][CH3:2].([CH:3]#[*:4].[CH2:5]=[*:6])>>[C:1](#[*:4])[*:99][CH:2](=[*:6]).[CH3:3][CH3:5]'
    SMARTS[1][336]='[CH3:1][*:99][CH3:2].([CH:3]#[*:4].[CH:5]#[*:6])>>[C:1](#[*:4])[*:99][C:2](#[*:6]).[CH3:3][CH3:5]'
    SMARTS[1][337]='[CH:1]([*:3])=[*:99]=[CH:2]([*:4]).([CH3:5][*:6].[CH3:7][*:8])>>[C:1]([*:3])([*:6])=[*:99]=[C:2]([*:4])[*:8].[CH3:5][CH3:7]'
    SMARTS[1][338]='[CH2:1]=[*:99]=[CH:2][*:3].([CH2:4]([*:5])[*:6].[CH3:7][*:8])>>[C:1]([*:5])([*:6])=[*:99]=[C:2]([*:3])[*:8].[CH3:4][CH3:7]'
    SMARTS[1][339]='[CH:1]([*:3])=[*:99]=[CH2:2].([CH3:4][*:5].[CH3:6][*:7])>>[C:1]([*:3])([*:5])=[*:99]=[CH:2][*:7].[CH3:4][CH3:6]'
    SMARTS[1][340]='[CH:1]([*:3])=[*:99]=[CH2:2].([CH3:4][*:5].[CH2:6]=[*:7])>>[C:1]([*:3])([*:5])=[*:99]=[C:2]=[*:7].[CH3:4][CH3:6]'
    SMARTS[1][341]='[CH2:1]=[*:99]=[CH2:2].([CH2:3]([*:4])[*:5].[CH2:6]([*:7])[*:8])>>[C:1]([*:4])([*:5])=[*:99]=[C:2]([*:7])[*:8].[CH3:3][CH3:6]'
    SMARTS[1][342]='[CH2:1]=[*:99]=[CH2:2].([CH3:3][*:4].[CH2:5]([*:6])[*:7])>>[CH:1]([*:4])=[*:99]=[C:2]([*:6])[*:7].[CH3:3][CH3:5]'
    #SMARTS[1][]='[CH2:1]=[*:99]=[CH2:2].([CH2:3]=[*:4].[CH2:5]([*:6])[*:7])>>[C:1](=[*:4])=[*:99]=[C:2]([*:6])[*:7].[CH3:3][CH3:5]'
    SMARTS[1][343]='[CH2:1]=[*:99]=[CH2:2].([CH3:3][*:4].[CH3:5][*:6])>>[CH:1]([*:4])=[*:99]=[CH:2][*:6].[CH3:3][CH3:5]'
    #SMARTS[1][]='[CH2:1]=[*:99]=[CH2:2].([CH2:3]=[*:4].[CH3:5][*:6])>>[C:1](=[*:4])=[*:99]=[CH:2][*:6].[CH3:3][CH3:5]'
    #SMARTS[1][]='[CH2:1]=[*:99]=[CH2:2].([CH2:3]=[*:4].[CH2:5]=[*:6])>>[C:1](=[*:4])=[*:99]=[C:2]=[*:6].[CH3:3][CH3:5]'
    SMARTS[1][344]='[CH:1](=[*:3])[*:99][CH:2]([*:4])[*:5].([CH3:6][*:7].[CH3:8][*:9])>>[C:1](=[*:3])([*:7])[*:99][C:2]([*:4])([*:5])[*:9].[CH3:6][CH3:8]'
    SMARTS[1][345]='[CH:1](=[*:3])[*:99][CH2:2][*:4].([CH2:5]([*:6])[*:7].[CH3:8][*:9])>>[C:1](=[*:3])([*:9])[*:99][C:2]([*:4])([*:6])[*:7].[CH3:5][CH3:8]'
    SMARTS[1][346]='[CH:1](=[*:3])[*:99][CH2:2][*:4].([CH3:5][*:6].[CH3:7][*:8])>>[C:1](=[*:3])([*:6])[*:99][CH:2]([*:4])[*:8].[CH3:5][CH3:7]'
    SMARTS[1][347]='[CH:1](=[*:3])[*:99][CH:2]=[*:4].([CH3:5][*:6].[CH3:7][*:8])>>[C:1](=[*:3])([*:6])[*:99][C:2](=[*:4])[*:8].[CH3:5][CH3:7]'
    SMARTS[1][348]='[CH:1](=[*:3])[*:99][CH3:2].([CH2:4]([*:5])[*:6].[CH3:7][*:8])>>[C:1](=[*:3])([*:8])[*:99][CH:2]([*:5])[*:6].[CH3:4][CH3:7]'
    SMARTS[1][349]='[CH:1](=[*:3])[*:99][CH3:2].([CH3:4][*:5].[CH2:6]=[*:7])>>[C:1](=[*:3])([*:5])[*:99][CH:2]=[*:7].[CH3:4][CH3:6]'
    SMARTS[1][350]='[NH:1]([*:3])[*:99][NH:2][*:4].([NH2:5][*:6].[NH2:7][*:8])>>[N:1]([*:3])([*:6])[*:99][N:2]([*:4])[*:8].[NH2:5][NH2:7]'
    SMARTS[1][351]='[NH:1]([*:3])[*:99][NH2:2].([NH2:4][*:5].[NH:6]([*:7])[*:8])>>[N:1]([*:3])([*:5])[*:99][N:2]([*:7])[*:8].[NH2:4][NH2:6]'
    SMARTS[1][352]='[NH:1]([*:3])[*:99][NH2:2].([NH2:4][*:5].[NH2:6][*:7])>>[N:1]([*:3])([*:5])[*:99][NH:2][*:7].[NH2:4][NH2:6]'
    SMARTS[1][353]='[NH:1]([*:3])[*:99][NH2:2].([NH2:4][*:5].[NH:6]=[*:7])>>[N:1]([*:3])([*:5])[*:99][N:2]=[*:7].[NH2:4][NH2:6]'
    SMARTS[1][354]='[NH2:1][*:99][NH2:2].([NH:3]([*:4])[*:5].[NH:6]([*:7])[*:8])>>[N:1]([*:4])([*:5])[*:99][N:2]([*:7])[*:8].[NH2:3][NH2:6]'
    SMARTS[1][355]='[NH2:1][*:99][NH2:2].([NH:3]([*:4])[*:5].[NH2:6][*:7])>>[N:1]([*:4])([*:5])[*:99][NH:2][*:7].[NH2:3][NH2:6]'
    SMARTS[1][356]='[NH2:1][*:99][NH2:2].([NH:3]([*:4])[*:5].[NH:6]=[*:7])>>[N:1]([*:4])([*:5])[*:99][N:2]=[*:7].[NH2:3][NH2:6]'
    SMARTS[1][357]='[NH2:1][*:99][NH2:2].([NH2:3][*:4].[NH2:5][*:6])>>[NH:1]([*:4])[*:99][NH:2][*:6].[NH2:3][NH2:5]'
    SMARTS[1][358]='[NH2:1][*:99][NH2:2].([NH:3]=[*:4].[NH2:5][*:6])>>[N:1](=[*:4])[*:99][NH:2][*:6].[NH2:3][NH2:5]'
    SMARTS[1][359]='[NH2:1][*:99][NH2:2].([NH:3]=[*:4].[NH:5]=[*:6])>>[N:1](=[*:4])[*:99][N:2]=[*:6].[NH2:3][NH2:5]'
    SMARTS[1][360]='[OH:1][*:99][OH:2].([OH:3][*:4].[OH:5][*:6])>>[O:1]([*:4])[*:99][O:2][*:6].[OH:3][OH:5]'
    SMARTS[1][361]='[CH:1]([*:3])([*:4])[*:99][NH:2][*:5].([CH3:6][*:7].[NH2:8][*:9])>>[C:1]([*:3])([*:4])([*:7])[*:99][N:2]([*:5])[*:9].[CH3:6][NH2:8]'
    SMARTS[1][362]='[CH2:1]([*:3])[*:99][NH:2][*:4].([CH2:5]([*:6])[*:7].[CH3:8][*:9])>>[C:1]([*:3])([*:6])([*:7])[*:99][N:2]([*:4])[*:9].[CH3:5][CH3:8]'
    SMARTS[1][363]='[CH2:1]([*:3])[*:99][NH:2][*:4].([CH3:5][*:6].[NH2:7][*:8])>>[CH:1]([*:3])([*:6])[*:99][N:2]([*:4])[*:8].[CH3:5][NH2:7]'
    SMARTS[1][364]='[CH2:1]([*:3])[*:99][NH:2][*:4].([CH2:5]=[*:6].[NH2:7][*:8])>>[C:1]([*:3])(=[*:6])[*:99][N:2]([*:4])[*:8].[CH3:5][NH2:7]'
    SMARTS[1][365]='[CH:1](=[*:3])[*:99][NH:2][*:4].([CH3:5][*:6].[NH2:7][*:8])>>[C:1](=[*:3])([*:6])[*:99][N:2]([*:4])[*:8].[CH3:5][NH2:7]'
    SMARTS[1][366]='[CH3:1][*:99][NH:2][*:3].([CH:5]([*:6])([*:7])[*:8].[CH3:9][*:10])>>[C:1]([*:6])([*:7])([*:8])[*:99][N:2]([*:3])[*:10].[CH3:5][NH2:9]'
    SMARTS[1][367]='[CH3:1][*:99][NH:2][*:3].([CH2:4]([*:5])[*:6].[NH2:7][*:8])>>[CH:1]([*:5])([*:6])[*:99][N:2]([*:3])[*:8].[CH3:4][NH2:7]'
    SMARTS[1][368]='[CH3:1][*:99][NH:2][*:3].([CH3:4][*:5].[NH2:6][*:7])>>[CH2:1]([*:5])[*:99][N:2]([*:3])[*:7].[CH3:4][NH2:6]'
    SMARTS[1][369]='[CH3:1][*:99][NH:2][*:3].([CH2:4]=[*:5].[NH2:6][*:7])>>[CH:1](=[*:5])[*:99][N:2]([*:3])[*:7].[CH3:4][NH2:6]'
    SMARTS[1][370]='[CH3:1][*:99][NH:2][*:3].([CH:4]#[*:5].[NH2:6][*:7])>>[C:1](#[*:5])[*:99][N:2]([*:3])[*:7].[CH3:4][NH2:6]'
    SMARTS[1][371]='[CH:1]([*:3])([*:4])[*:99][NH2:2].([CH3:5][*:6].[NH2:7][*:8])>>[C:1]([*:3])([*:4])([*:6])[*:99][NH:2][*:8].[CH3:5][NH2:7]'
    SMARTS[1][372]='[CH:1]([*:3])([*:4])[*:99][NH2:2].([CH3:5][*:6].[NH:7]=[*:8])>>[C:1]([*:3])([*:4])([*:6])[*:99][N:2]=[*:8].[CH3:5][NH2:7]'
    SMARTS[1][373]='[CH2:1]([*:3])[*:99][NH2:2].([CH2:4]([*:5])[*:6].[NH:7]([*:8])[*:9])>>[C:1]([*:3])([*:5])([*:6])[*:99][N:2]([*:8])[*:9].[CH3:4][NH2:7]'
    SMARTS[1][374]='[CH2:1]([*:3])[*:99][NH2:2].([CH3:4][*:5].[NH:6]([*:7])[*:8])>>[CH:1]([*:3])([*:5])[*:99][N:2]([*:7])[*:8].[CH3:4][NH2:6]'
    SMARTS[1][375]='[CH2:1]([*:3])[*:99][NH2:2].([CH2:4]=[*:5].[NH:6]([*:7])[*:8])>>[C:1]([*:3])(=[*:5])[*:99][N:2]([*:7])[*:8].[CH3:4][NH2:6]'
    SMARTS[1][376]='[CH2:1]([*:3])[*:99][NH2:2].([CH2:4]([*:5])[*:6].[NH2:7][*:8])>>[C:1]([*:3])([*:5])([*:6])[*:99][NH:2][*:8].[CH3:4][NH2:7]'
    SMARTS[1][377]='[CH2:1]([*:3])[*:99][NH2:2].([CH3:4][*:5].[NH2:6][*:7])>>[CH:1]([*:3])([*:5])[*:99][NH:2][*:7].[CH3:4][NH2:6]'
    SMARTS[1][378]='[CH2:1]([*:3])[*:99][NH2:2].([CH2:4]=[*:5].[NH2:6][*:7])>>[C:1]([*:3])(=[*:5])[*:99][NH:2][*:7].[CH3:4][NH2:6]'
    SMARTS[1][379]='[CH2:1]([*:3])[*:99][NH2:2].([CH2:4]([*:5])[*:6].[NH:7]=[*:8])>>[C:1]([*:3])([*:5])([*:6])[*:99][N:2]=[*:8].[CH3:4][NH2:7]'
    SMARTS[1][380]='[CH2:1]([*:3])[*:99][NH2:2].([CH3:4][*:5].[NH:6]=[*:7])>>[CH:1]([*:3])([*:5])[*:99][N:2]=[*:7].[CH3:4][NH2:6]'
    SMARTS[1][381]='[CH2:1]([*:3])[*:99][NH2:2].([CH2:4]=[*:5].[NH:6]=[*:7])>>[C:1]([*:3])(=[*:5])[*:99][N:2]=[*:7].[CH3:4][NH2:6]'
    SMARTS[1][382]='[CH:1](=[*:3])[*:99][NH2:2].([CH3:4][*:5].[NH2:6][*:7])>>[C:1](=[*:3])([*:5])[*:99][NH:2][*:7].[CH3:4][NH2:6]'
    SMARTS[1][383]='[CH3:1][*:99][NH2:2].([CH:3]([*:4])([*:5])[*:6].[NH:7]([*:8])[*:9])>>[C:3]([*:4])([*:5])([*:6])[*:99][N:2]([*:8])[*:9].[CH3:3][NH2:7]'
    SMARTS[1][384]='[CH3:1][*:99][NH2:2].([CH2:3]([*:4])[*:5].[NH:6]([*:7])[*:8])>>[CH:1]([*:4])([*:5])[*:99][N:2]([*:7])[*:8].[CH3:3][NH2:6]'
    SMARTS[1][385]='[CH3:1][*:99][NH2:2].([CH3:3][*:4].[NH:5]([*:6])[*:7])>>[CH2:1]([*:4])[*:99][N:2]([*:6])[*:7].[CH3:3][NH2:5]'
    SMARTS[1][386]='[CH3:1][*:99][NH2:2].([CH:3](=[*:4])[*:5].[NH:6]([*:7])[*:8])>>[C:1](=[*:4])([*:5])[*:99][N:2]([*:7])[*:8].[CH3:3][NH2:6]'
    SMARTS[1][387]='[CH3:1][*:99][NH2:2].([CH2:3]=[*:4].[NH:5]([*:6])[*:7])>>[CH:1](=[*:4])[*:99][N:2]([*:6])[*:7].[CH3:3][NH2:5]'
    SMARTS[1][388]='[CH3:1][*:99][NH2:2].([CH:3]#[*:4].[NH:5]([*:6])[*:7])>>[C:1](#[*:4])[*:99][N:2]([*:6])[*:7].[CH3:3][NH2:5]'
    SMARTS[1][389]='[CH3:1][*:99][NH2:2].([CH:3]([*:4])([*:5])[*:6].[NH2:7][*:8])>>[C:1]([*:4])([*:5])([*:6])[*:99][NH:2][*:8].[CH3:3][NH2:7]'
    SMARTS[1][390]='[CH3:1][*:99][NH2:2].([CH2:3]([*:4])[*:5].[NH2:6][*:7])>>[CH:1]([*:4])([*:5])[*:99][NH:2][*:7].[CH3:3][NH2:6]'
    SMARTS[1][391]='[CH3:1][*:99][NH2:2].([CH3:3][*:4].[NH2:5][*:6])>>[CH2:1]([*:4])[*:99][NH:2][*:6].[NH2:5][CH3:3]'
    SMARTS[1][392]='[CH3:1][*:99][NH2:2].([CH:3](=[*:4])[*:5].[NH2:6][*:7])>>[C:1](=[*:4])([*:5])[*:99][NH:2][*:7].[CH3:3][NH2:6]'
    SMARTS[1][393]='[CH3:1][*:99][NH2:2].([CH2:3]=[*:4].[NH2:5][*:6])>>[CH:1](=[*:4])[*:99][NH:2][*:6].[NH2:5][CH3:3]'
    SMARTS[1][394]='[CH3:1][*:99][NH2:2].([CH:3]#[*:4].[NH2:5][*:6])>>[C:1](#[*:4])[*:99][NH:2][*:6].[NH2:5][CH3:3]'
    SMARTS[1][395]='[CH3:1][*:99][NH2:2].([CH:3]([*:4])([*:5])[*:6].[NH:7]=[*:8])>>[C:1]([*:4])([*:5])([*:6])[*:99][N:2]=[*:8].[CH3:3][NH2:7]'
    SMARTS[1][396]='[CH3:1][*:99][NH2:2].([CH2:3]([*:4])[*:5].[NH:6]=[*:7])>>[CH:1]([*:4])([*:5])[*:99][N:2]=[*:7].[CH3:3][NH2:6]'
    SMARTS[1][397]='[CH3:1][*:99][NH2:2].([CH3:3][*:4].[NH:5]=[*:6])>>[CH2:1]([*:4])[*:99][N:2]=[*:6].[NH2:5][CH3:3]'
    SMARTS[1][398]='[CH3:1][*:99][NH2:2].([CH:3](=[*:4])[*:5].[NH:6]=[*:7])>>[C:1](=[*:4])([*:5])[*:99][N:2]=[*:7].[CH3:3][NH2:6]'
    SMARTS[1][399]='[CH3:1][*:99][NH2:2].([CH2:3]=[*:4].[NH:5]=[*:6])>>[CH:1](=[*:4])[*:99][N:2]=[*:6].[NH2:5][CH3:3]'
    SMARTS[1][400]='[CH3:1][*:99][NH2:2].([CH:3]#[*:4].[NH:5]=[*:6])>>[C:1](#[*:4])[*:99][N:2]=[*:6].[NH2:5][CH3:3]'
    SMARTS[1][401]='[CH:1]([*:3])=[*:99]=[NH:2].([CH3:4][*:5].[NH2:6][*:7])>>[C:1]([*:3])([*:5])=[*:99]=[N:2][*:7].[CH3:4][NH2:6]'
    SMARTS[1][402]='[CH2:1]=[*:99]=[NH:2].([CH2:3]([*:4])[*:5].[NH2:6][*:7])>>[C:1]([*:4])([*:5])=[*:99]=[N:2][*:7].[CH3:3][NH2:6]'
    SMARTS[1][403]='[CH2:1]=[*:99]=[NH:2].([CH3:3][*:4].[NH2:5][*:6])>>[CH:1]([*:4])=[*:99]=[N:2][*:6].[CH3:3][NH2:5]'
    #SMARTS[1][]='[CH2:1]=[*:99]=[NH:2].([CH2:3]=[*:4].[NH2:5][*:6])>>[C:1](=[*:4])=[*:99]=[N:2][*:6].[CH3:3][NH2:5]'
    SMARTS[1][404]='[CH:1]([*:3])([*:4])[*:99][OH:2].([CH3:5][*:6].[OH:7][*:8])>>[C:1]([*:3])([*:4])([*:6])[*:99][O:2][*:8].[CH3:5][OH:7]'
    SMARTS[1][405]='[CH2:1]([*:3])[*:99][OH:2].([CH2:4]([*:5])[*:6].[OH:7][*:8])>>[C:1]([*:3])([*:5])([*:6])[*:99][O:2][*:8].[CH3:4][OH:7]'
    SMARTS[1][406]='[CH2:1]([*:3])[*:99][OH:2].([CH3:4][*:5].[OH:6][*:7])>>[CH:1]([*:3])([*:5])[*:99][O:2][*:7].[CH3:4][OH:6]'
    SMARTS[1][407]='[CH2:1]([*:3])[*:99][OH:2].([CH2:4]=[*:5].[OH:6][*:7])>>[C:1]([*:3])(=[*:5])[*:99][O:2][*:7].[CH3:4][OH:6]'
    SMARTS[1][408]='[CH3:1][*:99][OH:2].([CH:3]([*:4])([*:5])[*:6].[OH:7][*:8])>>[C:1]([*:4])([*:5])([*:6])[*:99][O:2][*:8].[CH3:3][OH:7]'
    SMARTS[1][409]='[CH3:1][*:99][OH:2].([CH2:3]([*:4])[*:5].[OH:6][*:7])>>[CH:1]([*:4])([*:5])[*:99][O:2][*:7].[CH3:3][OH:6]'
    SMARTS[1][410]='[CH3:1][*:99][OH:2].([CH3:3][*:4].[OH:5][*:6])>>[CH2:1]([*:4])[*:99][O:2][*:6].[CH3:3][OH:5]'
    SMARTS[1][411]='[CH3:1][*:99][OH:2].([CH:3](=[*:4])[*:5].[OH:6][*:7])>>[C:1](=[*:4])([*:5])[*:99][O:2][*:7].[CH3:3][OH:6]'
    SMARTS[1][412]='[CH3:1][*:99][OH:2].([CH2:3]=[*:4].[OH:5][*:6])>>[CH:1](=[*:4])[*:99][O:2][*:6].[CH3:3][OH:5]'
    SMARTS[1][413]='[CH3:1][*:99][OH:2].([CH:3]#[*:4].[OH:5][*:6])>>[C:1](#[*:4])[*:99][O:2][*:6].[CH3:3][OH:5]'
    SMARTS[1][414]='[CH:1](=[*:3])[*:99][OH:2].([CH3:4][*:5].[OH:6][*:7])>>[C:1](=[*:3])([*:5])[O:2][*:7].[CH3:4][OH:6]'
    SMARTS[1][415]='[NH:1]([*:3])[*:99][OH:2].([NH2:4][*:5].[OH:6][*:7])>>[N:1]([*:3])([*:5])[*:99][O:2][*:7].[NH2:4][OH:6]'
    SMARTS[1][416]='[NH2:1][*:99][OH:2].([NH:3]([*:4])[*:5].[OH:6][*:7])>>[N:1]([*:4])([*:5])[*:99][O:2][*:7].[NH2:3][OH:6]'
    SMARTS[1][417]='[NH2:1][*:99][OH:2].([NH2:3][*:4].[OH:5][*:6])>>[NH:1]([*:4])[*:99][O:2][*:6].[NH2:3][OH:5]'
    SMARTS[1][418]='[NH2:1][*:99][OH:2].([NH:3]=[*:4].[OH:5][*:6])>>[N:1](=[*:4])[*:99][O:2][*:6].[NH2:3][OH:5]'

    SMARTS[1][419]='[CH:1]([*:4])([*:5])[*:2]=[CH:3][*:6].([CH3:7][*:8].[CH3:9][*:10])>>[C:1]([*:4])([*:5])([*:8])[*:2]=[C:3]([*:6])[*:10].[CH3:7][CH3:9]'
    SMARTS[1][420]='[CH2:1]([*:4])[*:2]=[CH:3][*:5].([CH2:6]([*:7])[*:8].[CH3:9][*:10])>>[C:1]([*:4])([*:7])([*:8])[*:2]=[C:3]([*:5])[*:10].[CH3:6][CH3:9]'
    SMARTS[1][421]='[CH2:1]([*:4])[*:2]=[CH:3][*:5].([CH3:6][*:7].[CH3:8][*:9])>>[CH:1]([*:4])([*:7])[*:2]=[C:3]([*:5])[*:9].[CH3:6][CH3:8]'
    SMARTS[1][422]='[CH2:1]([*:4])[*:2]=[CH:3][*:5].([CH2:6]=[*:7].[CH3:8][*:9])>>[C:1]([*:4])(=[*:7])[*:2]=[C:3]([*:5])[*:9].[CH3:6][CH3:8]'
    SMARTS[1][423]='[CH:1](=[*:4])[*:2]=[CH:3][*:5].([CH3:6][*:7].[CH3:8][*:9])>>[C:1](=[*:4])([*:7])[*:2]=[C:3]([*:5])[*:9].[CH3:6][CH3:8]'
    SMARTS[1][424]='[CH3:1][*:2]=[CH:3][*:4].([CH:5]([*:6])([*:7])[*:8].[CH3:9][*:10])>>[C:1]([*:6])([*:7])([*:8])[*:2]=[C:3]([*:4])[*:10].[CH3:5][CH3:9]'
    SMARTS[1][425]='[CH3:1][*:2]=[CH:3][*:4].([CH2:5]([*:6])[*:7].[CH3:8][*:10])>>[CH:1]([*:6])([*:7])[*:2]=[C:3]([*:4])[*:10].[CH3:5][CH3:8]'
    SMARTS[1][426]='[CH3:1][*:2]=[CH:3][*:4].([CH3:5][*:6].[CH3:7][*:8])>>[CH2:1]([*:6])[*:2]=[C:3]([*:4])[*:8].[CH3:5][CH3:7]'
    SMARTS[1][427]='[CH3:1][*:2]=[CH:3][*:4].([CH:5](=[*:6])[*:7].[CH3:8][*:10])>>[C:1](=[*:6])([*:7])[*:2]=[C:3]([*:4])[*:10].[CH3:5][CH3:8]'
    SMARTS[1][428]='[CH3:1][*:2]=[CH:3][*:4].([CH2:5]=[*:6].[CH3:7][*:8])>>[CH:1](=[*:6])[*:2]=[C:3]([*:4])[*:8].[CH3:5][CH3:7]'
    SMARTS[1][429]='[CH3:1][*:2]=[CH:3][*:4].([CH:5]#[*:6].[CH3:7][*:8])>>[C:1](#[*:6])[*:2]=[C:3]([*:4])[*:8].[CH3:5][CH3:7]'
    SMARTS[1][430]='[CH:1]([*:4])([*:5])[*:2]=[CH2:3].([CH3:6][*:7].[CH2:8]([*:9])[*:10])>>[C:1]([*:4])([*:5])([*:7])[*:2]=[C:3]([*:9])[*:10].[CH3:6][CH3:8]'
    SMARTS[1][431]='[CH:1]([*:4])([*:5])[*:2]=[CH2:3].([CH3:6][*:7].[CH3:8][*:9])>>[C:1]([*:4])([*:5])([*:7])[*:2]=[CH:3][*:9].[CH3:6][CH3:8]'
    SMARTS[1][432]='[CH:1]([*:4])([*:5])[*:2]=[CH2:3].([CH3:6][*:7].[CH2:8]=[*:9])>>[C:1]([*:4])([*:5])([*:7])[*:2]=[C:3]=[*:9].[CH3:6][CH3:8]'
    SMARTS[1][433]='[CH2:1]([*:4])[*:2]=[CH2:3].([CH2:5]([*:6])[*:7].[CH2:8]([*:9])[*:10])>>[C:1]([*:4])([*:6])([*:7])[*:2]=[C:3]([*:9])[*:10].[CH3:5][CH3:8]'
    SMARTS[1][434]='[CH2:1]([*:4])[*:2]=[CH2:3].([CH3:5][*:6].[CH2:7]([*:8])[*:9])>>[CH:1]([*:4])([*:6])[*:2]=[C:3]([*:8])[*:9].[CH3:5][CH3:7]'
    SMARTS[1][435]='[CH2:1]([*:4])[*:2]=[CH2:3].([CH2:5]=[*:6].[CH2:7]([*:8])[*:9])>>[C:1]([*:4])(=[*:6])[*:2]=[C:3]([*:8])[*:9].[CH3:5][CH3:7]'
    SMARTS[1][436]='[CH2:1]([*:4])[*:2]=[CH2:3].([CH2:5]([*:6])[*:7].[CH3:8][*:9])>>[C:1]([*:4])([*:6])([*:7])[*:2]=[CH:3][*:9].[CH3:5][CH3:8]'
    SMARTS[1][437]='[CH2:1]([*:4])[*:2]=[CH2:3].([CH3:5][*:6].[CH3:7][*:8])>>[CH:1]([*:4])([*:6])[*:2]=[CH:3][*:8].[CH3:5][CH3:7]'
    SMARTS[1][438]='[CH2:1]([*:4])[*:2]=[CH2:3].([CH2:5]=[*:6].[CH3:7][*:8])>>[C:1]([*:4])(=[*:6])[*:2]=[CH:3][*:8].[CH3:5][CH3:7]'
    SMARTS[1][439]='[CH2:1]([*:4])[*:2]=[CH2:3].([CH2:5]([*:6])[*:7].[CH2:8]=[*:9])>>[C:1]([*:4])([*:6])([*:7])[*:2]=[C:3]=[*:9].[CH3:5][CH3:8]'
    SMARTS[1][440]='[CH2:1]([*:4])[*:2]=[CH2:3].([CH3:5][*:6].[CH2:7]=[*:8])>>[CH:1]([*:4])([*:6])[*:2]=[C:3]=[*:8].[CH3:5][CH3:7]'
    SMARTS[1][441]='[CH2:1]([*:4])[*:2]=[CH2:3].([CH2:5]=[*:6].[CH2:7]=[*:8])>>[C:1]([*:4])(=[*:6])[*:2]=[C:3]=[*:8].[CH3:5][CH3:7]'
    SMARTS[1][442]='[CH:1](=[*:4])[*:2]=[CH2:3].([CH3:5][*:6].[CH3:7][*:8])>>[C:1](=[*:4])([*:6])[*:2]=[CH:3][*:8].[CH3:5][CH3:7]'
    SMARTS[1][443]='[CH:1](=[*:4])[*:2]=[CH2:3].([CH3:5][*:6].[CH2:7]=[*:8])>>[C:1](=[*:4])([*:6])[*:2]=[C:3]=[*:8].[CH3:5][CH3:7]'

    SMARTS[1][444]='[CH3:1][*:2]=[CH2:3].([CH:4]([*:5])([*:6])[*:7].[CH2:8]([*:9])[*:10])>>[C:1]([*:5])([*:6])([*:7])[*:2]=[C:3]([*:9])[*:10].[CH3:4][CH3:8]'
    SMARTS[1][445]='[CH3:1][*:2]=[CH2:3].([CH2:4]([*:5])[*:6].[CH2:7]([*:8])[*:9])>>[CH:1]([*:5])([*:6])[*:2]=[C:3]([*:8])[*:9].[CH3:4][CH3:7]'
    SMARTS[1][446]='[CH3:1][*:2]=[CH2:3].([CH3:4][*:5].[CH2:6]([*:7])[*:8])>>[CH2:1]([*:5])[*:2]=[C:3]([*:7])[*:8].[CH3:4][CH3:6]'
    SMARTS[1][447]='[CH3:1][*:2]=[CH2:3].([CH:4](=[*:5])[*:6].[CH2:7]([*:8])[*:9])>>[C:1](=[*:5])([*:6])[*:2]=[C:3]([*:8])[*:9].[CH3:4][CH3:7]'
    SMARTS[1][448]='[CH3:1][*:2]=[CH2:3].([CH2:4]=[*:5].[CH2:6]([*:7])[*:8])>>[CH:1](=[*:5])[*:2]=[C:3]([*:7])[*:8].[CH3:4][CH3:6]'
    SMARTS[1][449]='[CH3:1][*:2]=[CH2:3].([CH:4]#[*:5].[CH2:6]([*:7])[*:8])>>[C:1](#[*:5])[*:2]=[C:3]([*:7])[*:8].[CH3:4][CH3:6]'

    SMARTS[1][450]='[CH3:1][*:2]=[CH2:3].([CH:4]([*:5])([*:6])[*:7].[CH3:8][*:9])>>[C:1]([*:5])([*:6])([*:7])[*:2]=[CH:3][*:9].[CH3:4][CH3:8]'
    SMARTS[1][451]='[CH3:1][*:2]=[CH2:3].([CH2:4]([*:5])[*:6].[CH3:7][*:8])>>[CH:1]([*:5])([*:6])[*:2]=[CH:3][*:8].[CH3:4][CH3:7]'
    SMARTS[1][452]='[CH3:1][*:2]=[CH2:3].([CH3:4][*:5].[CH3:6][*:7])>>[CH2:1]([*:5])[*:2]=[CH:3][*:7].[CH3:4][CH3:6]'
    SMARTS[1][453]='[CH3:1][*:2]=[CH2:3].([CH:4](=[*:5])[*:6].[CH3:7][*:8])>>[C:1](=[*:5])([*:6])[*:2]=[CH:3][*:8].[CH3:4][CH3:7]'
    SMARTS[1][454]='[CH3:1][*:2]=[CH2:3].([CH2:4]=[*:5].[CH3:6][*:7])>>[CH:1](=[*:5])[*:2]=[CH:3][*:7].[CH3:4][CH3:6]'
    SMARTS[1][455]='[CH3:1][*:2]=[CH2:3].([CH:4]#[*:5].[CH3:6][*:7])>>[C:1](#[*:5])[*:2]=[CH:3][*:7].[CH3:4][CH3:6]'

    SMARTS[1][456]='[CH3:1][*:2]=[CH2:3].([CH:4]([*:5])([*:6])[*:7].[CH2:8]=[*:9])>>[C:1]([*:5])([*:6])([*:7])[*:2]=[C:3]=[*:9].[CH3:4][CH3:8]'
    SMARTS[1][457]='[CH3:1][*:2]=[CH2:3].([CH2:4]([*:5])[*:6].[CH2:7]=[*:8])>>[CH:1]([*:5])([*:6])[*:2]=[C:3]=[*:8].[CH3:4][CH3:7]'
    SMARTS[1][458]='[CH3:1][*:2]=[CH2:3].([CH3:4][*:5].[CH2:6]=[*:7])>>[CH2:1]([*:5])[*:2]=[C:3]=[*:7].[CH3:4][CH3:6]'
    SMARTS[1][459]='[CH3:1][*:2]=[CH2:3].([CH:4](=[*:5])[*:6].[CH2:7]=[*:8])>>[C:1](=[*:5])([*:6])[*:2]=[C:3]=[*:8].[CH3:4][CH3:7]'
    SMARTS[1][460]='[CH3:1][*:2]=[CH2:3].([CH2:4]=[*:5].[CH2:6]=[*:7])>>[CH:1](=[*:5])[*:2]=[C:3]=[*:7].[CH3:4][CH3:6]'
    SMARTS[1][461]='[CH3:1][*:2]=[CH2:3].([CH:4]#[*:5].[CH2:6]=[*:7])>>[C:1](#[*:5])[*:2]=[C:3]=[*:7].[CH3:4][CH3:6]'

    SMARTS[1][462]='[CH:1]([*:4])([*:5])[*:2]#[CH:3].([CH3:6][*:7].[CH3:8][*:9])>>[C:1]([*:4])([*:5])([*:7])[*:2]#[C:3][*:9].[CH3:6][CH3:8]'
    SMARTS[1][463]='[CH2:1]([*:4])[*:2]#[CH:3].([CH2:5]([*:6])[*:7].[CH3:8][*:9])>>[C:1]([*:4])([*:6])([*:7])[*:2]#[C:3][*:9].[CH3:5][CH3:8]'
    SMARTS[1][464]='[CH2:1]([*:4])[*:2]#[CH:3].([CH3:5][*:6].[CH3:7][*:8])>>[CH:1]([*:4])([*:6])[*:2]#[C:3][*:8].[CH3:5][CH3:7]'
    SMARTS[1][465]='[CH2:1]([*:4])[*:2]#[CH:3].([CH2:5]=[*:6].[CH3:7][*:8])>>[C:1]([*:4])(=[*:6])[*:2]#[C:3][*:8].[CH3:5][CH3:7]'
    SMARTS[1][466]='[CH:1](=[*:4])[*:2]#[CH:3].([CH3:5][*:6].[CH3:7][*:8])>>[C:1](=[*:4])([*:6])[*:2]#[C:3][*:8].[CH3:5][CH3:7]'

    SMARTS[1][467]='[CH3:1][*:2]#[CH:3].([CH:4]([*:5])([*:6])[*:7].[CH3:8][*:9])>>[C:1]([*:5])([*:6])([*:7])[*:2]#[C:3][*:9].[CH3:4][CH3:8]'
    SMARTS[1][468]='[CH3:1][*:2]#[CH:3].([CH2:4]([*:5])[*:6].[CH3:7][*:8])>>[CH:1]([*:5])([*:6])[*:2]#[C:3][*:8].[CH3:4][CH3:7]'
    SMARTS[1][469]='[CH3:1][*:2]#[CH:3].([CH3:4][*:5].[CH3:6][*:7])>>[CH2:1]([*:5])[*:2]#[C:3][*:7].[CH3:4][CH3:6]'
    SMARTS[1][470]='[CH3:1][*:2]#[CH:3].([CH:4](=[*:5])[*:6].[CH3:7][*:8])>>[C:1](=[*:5])([*:6])[*:2]#[C:3][*:8].[CH3:4][CH3:7]'
    SMARTS[1][471]='[CH3:1][*:2]#[CH:3].([CH2:4]=[*:5].[CH3:6][*:7])>>[CH:1](=[*:5])[*:2]#[C:3][*:7].[CH3:4][CH3:6]'
    SMARTS[1][472]='[CH3:1][*:2]#[CH:3].([CH:4]#[*:5].[CH3:6][*:7])>>[C:1](#[*:5])[*:2]#[C:3][*:7].[CH3:4][CH3:6]'

    SMARTS[1][473]='[NH:1]([*:4])[*:2]=[NH:3].([NH2:5][*:6].[NH2:7][*:8])>>[N:1]([*:4])([*:6])[*:2]=[N:3][*:8].[NH2:5][NH2:7]'
    SMARTS[1][474]='[NH2:1][*:2]=[NH:3].([NH:4]([*:5])[*:6].[NH2:7][*:8])>>[N:1]([*:5])([*:6])[*:2]=[N:3][*:8].[NH2:4][NH2:7]'
    SMARTS[1][475]='[NH2:1][*:2]=[NH:3].([NH2:4][*:5].[NH2:6][*:7])>>[NH:1]([*:5])[*:2]=[N:3][*:7].[NH2:4][NH2:6]'
    SMARTS[1][476]='[NH2:1][*:2]=[NH:3].([NH:4]=[*:5].[NH2:6][*:7])>>[N:1](=[*:5])[*:2]=[N:3][*:7].[NH2:4][NH2:6]'

    SMARTS[1][477]='[NH:1]([*:4])[*:2]=[CH:3][*:5].([NH2:6][*:7].[CH3:8][*:9])>>[N:1]([*:4])([*:7])[*:2]=[C:3]([*:5])[*:9].[NH2:6][CH3:8]'
    SMARTS[1][478]='[NH2:1][*:2]=[CH:3][*:4].([NH:5]([*:6])[*:7].[CH3:8][*:10])>>[N:1]([*:6])([*:7])[*:2]=[C:3]([*:4])[*:10].[NH2:5][CH3:8]'
    SMARTS[1][479]='[NH2:1][*:2]=[CH:3][*:4].([NH2:5][*:6].[CH3:7][*:8])>>[NH:1]([*:6])[*:2]=[C:3]([*:4])[*:8].[NH2:5][CH3:7]'
    SMARTS[1][480]='[NH2:1][*:2]=[CH:3][*:4].([NH:5]=[*:6].[CH3:7][*:8])>>[N:1](=[*:6])[*:2]=[C:3]([*:4])[*:8].[NH2:5][CH3:7]'
    SMARTS[1][481]='[CH:1]([*:4])([*:5])[*:2]=[NH:3].([CH3:6][*:7].[NH2:8][*:9])>>[C:1]([*:4])([*:5])([*:7])[*:2]=[N:3][*:9].[CH3:6][NH2:8]'
    SMARTS[1][482]='[NH:1]([*:4])[*:2]=[CH2:3].([NH2:5][*:6].[CH2:7]([*:8])[*:9])>>[N:1]([*:4])([*:6])[*:2]=[C:3]([*:8])[*:9].[NH2:5][CH3:7]'
    SMARTS[1][483]='[CH2:1]([*:4])[*:2]=[NH:3].([CH2:5]([*:6])[*:7].[NH2:8][*:9])>>[C:1]([*:4])([*:6])([*:7])[*:2]=[N:3][*:9].[CH3:5][NH2:8]'
    SMARTS[1][484]='[NH:1]([*:4])[*:2]=[CH2:3].([NH2:5][*:6].[CH3:7][*:8])>>[N:1]([*:4])([*:6])[*:2]=[CH:3][*:8].[NH2:5][CH3:7]'
    SMARTS[1][485]='[CH2:1]([*:4])[*:2]=[NH:3].([CH3:5][*:6].[NH2:7][*:8])>>[CH:1]([*:4])([*:6])[*:2]=[N:3][*:8].[CH3:5][NH2:7]'
    SMARTS[1][486]='[CH2:1]([*:4])[*:2]=[NH:3].([CH2:5]=[*:6].[NH2:7][*:8])>>[C:1]([*:4])(=[*:6])[*:2]=[N:3][*:8].[CH3:5][NH2:7]'
    SMARTS[1][487]='[NH:1]([*:4])[*:2]=[CH2:3].([NH2:5][*:6].[CH2:7]=[*:8])>>[N:1]([*:4])([*:6])[*:2]=[C:3]=[*:8].[NH2:5][CH3:7]'
    SMARTS[1][488]='[CH:1](=[*:4])[*:2]=[NH:3].([CH3:5][*:6].[NH2:7][*:8])>>[C:1](=[*:4])([*:6])[*:2]=[N:3][*:8].[CH3:5][NH2:7]'
    SMARTS[1][489]='[NH2:1][*:2]=[CH2:3].([NH:4]([*:5])[*:6].[CH2:7]([*:8])[*:9])>>[N:1]([*:5])([*:6])[*:2]=[C:3]([*:8])[*:9].[NH2:4][CH3:7]'
    SMARTS[1][490]='[NH2:1][*:2]=[CH2:3].([NH2:4][*:5].[CH2:6]([*:7])[*:8])>>[NH:1]([*:5])[*:2]=[C:3]([*:7])[*:8].[NH2:4][CH3:6]'
    SMARTS[1][491]='[NH2:1][*:2]=[CH2:3].([NH:4]=[*:5].[CH2:6]([*:7])[*:8])>>[N:1](=[*:5])[*:2]=[C:3]([*:7])[*:8].[NH2:4][CH3:6]'
    SMARTS[1][492]='[CH3:1][*:2]=[NH:3].([CH:4]([*:5])([*:6])[*:7].[NH2:8][*:9])>>[C:1]([*:5])([*:6])([*:7])[*:2]=[N:3][*:9].[CH3:4][NH2:8]'
    SMARTS[1][493]='[NH2:1][*:2]=[CH2:3].([NH:4]([*:5])[*:6].[CH3:7][*:8])>>[N:1]([*:5])([*:6])[*:2]=[CH:3][*:8].[NH2:4][CH3:7]'
    SMARTS[1][494]='[CH3:1][*:2]=[NH:3].([CH2:4]([*:5])[*:6].[NH2:7][*:8])>>[CH:1]([*:5])([*:6])[*:2]=[N:3][*:8].[CH3:4][NH2:7]'
    SMARTS[1][495]='[NH2:1][*:2]=[CH2:3].([NH2:4][*:5].[CH3:6][*:7])>>[NH:1]([*:5])[*:2]=[CH:3][*:7].[NH2:4][CH3:6]'
    SMARTS[1][496]='[CH3:1][*:2]=[NH:3].([CH3:4][*:5].[NH2:6][*:7])>>[CH2:1]([*:5])[*:2]=[N:3][*:7].[CH3:4][NH2:6]'
    SMARTS[1][497]='[CH3:1][*:2]=[NH:3].([CH:4](=[*:5])[*:6].[NH2:7][*:8])>>[C:1](=[*:5])([*:6])[*:2]=[N:3][*:8].[CH3:4][NH2:7]'
    SMARTS[1][498]='[NH2:1][*:2]=[CH2:3].([NH:4]=[*:5].[CH3:6][*:7])>>[N:1](=[*:5])[*:2]=[CH:3][*:7].[NH2:4][CH3:6]'
    SMARTS[1][499]='[CH3:1][*:2]=[NH:3].([CH2:4]=[*:5].[NH2:6][*:7])>>[CH:1](=[*:5])[*:2]=[N:3][*:7].[CH3:4][NH2:6]'
    SMARTS[1][500]='[CH3:1][*:2]=[NH:3].([CH:4]#[*:5].[NH2:6][*:7])>>[C:1](#[*:5])[*:2]=[N:3][*:7].[CH3:4][NH2:6]'
    SMARTS[1][501]='[NH2:1][*:2]=[CH2:3].([NH:4]([*:5])[*:6].[CH2:7]=[*:8])>>[N:1]([*:5])([*:6])[*:2]=[C:3]=[*:8].[NH2:4][CH3:7]'
    SMARTS[1][502]='[NH2:1][*:2]=[CH2:3].([NH2:4][*:5].[CH2:6]=[*:7])>>[NH:1]([*:5])[*:2]=[C:3]=[*:7].[NH2:4][CH3:6]'
    SMARTS[1][503]='[NH2:1][*:2]=[CH2:3].([NH:4]=[*:5].[CH2:6]=[*:7])>>[N:1](=[*:5])[*:2]=[C:3]=[*:7].[NH2:4][CH3:6]'
    SMARTS[1][504]='[NH:1]([*:4])[*:2]#[CH:3].([NH2:5][*:6].[CH3:7][*:8])>>[N:1]([*:4])([*:6])[*:2]#[C:3][*:8].[NH2:5][CH3:7]'
    SMARTS[1][505]='[NH2:1][*:2]#[CH:3].([NH:4]([*:5])[*:6].[CH3:7][*:8])>>[N:1]([*:5])([*:6])[*:2]#[C:3][*:8].[NH2:4][CH3:7]'
    SMARTS[1][506]='[NH2:1][*:2]#[CH:3].([NH2:4][*:5].[CH3:6][*:7])>>[NH:1]([*:5])[*:2]#[C:3][*:7].[NH2:4][CH3:6]'
    SMARTS[1][507]='[NH2:1][*:2]#[CH:3].([NH:4]=[*:5].[CH3:6][*:7])>>[N:1](=[*:5])[*:2]#[C:3][*:7].[NH2:4][CH3:6]'
    SMARTS[1][508]='[CH:1]([*:3])=[*:2][OH:4].([CH3:5][*:6].[OH:7][*:8])>>[C:1]([*:3])([*:6])=[*:2][O:4][*:8].[CH3:5][OH:7]'
    SMARTS[1][509]='[CH2:1]=[*:2][OH:3].([CH2:4]([*:5])[*:6].[OH:7][*:8])>>[C:1]([*:5])([*:6])=[*:2][O:3][*:8].[CH3:4][OH:7]'
    SMARTS[1][510]='[CH2:1]=[*:2][OH:3].([CH3:4][*:5].[OH:6][*:7])>>[CH:1]([*:5])=[*:2][O:3][*:7].[CH3:4][OH:6]'
    SMARTS[1][511]='[N:1]=[*:2][OH:3].([NH2:4][*:5].[OH:6][*:7])>>[N:1]([*:5])=[*:2][O:3][*:7].[NH2:4][OH:6]'
    
    #intramolecular carbon sp3
    SMARTS[2][0]='([CH:1]([*:2])([*:3])[*:4].[CH3:5][*:6])>>[C:1]([*:2])([*:3])([*:4])[*:6].[CH4:5]' #1
    SMARTS[2][1]='([CH2:1]([*:2])[*:3].[CH2:4]([*:5])[*:6])>>[C:1]([*:2])([*:3])([*:5])[*:6].[CH4:4]' #2
    SMARTS[2][2]='([CH2:1]([*:2])[*:3].[CH3:4][*:5])>>[CH:1]([*:2])([*:3])[*:5].[CH4:4]' #3
    SMARTS[2][3]='([CH3:1][*:2].[CH3:4][*:5])>>[CH2:1]([*:2])[*:5].[CH4:4]' #4

    #intramolecular carbon sp2
    SMARTS[2][4]='([CH:1](=[*:2])[*:3].[CH3:4][*:5])>>[C:1](=[*:2])([*:3])[*:5].[CH4:4]' #5
    SMARTS[2][5]='([CH2:1]=[*:2].[CH2:3]([*:4])[*:5])>>[C:1](=[*:2])([*:4])[*:5].[CH4:3]' #6
    SMARTS[2][6]='([CH2:1]=[*:2].[CH3:3][*:4])>>[CH:1](=[*:2])[*:4].[CH4:3]' #7
    SMARTS[2][7]='([CH2:1]=[*:2].[CH2:3]=[*:4])>>[C:1](=[*:2])=[*:4].[CH4:3]' #8

    #intramolecular carbon sp
    SMARTS[2][8]='([CH:1]#[*:2].[CH3:3][*:4])>>[C:1](#[*:2])[*:4].[CH4:3]' #9

    #intramolecular nitrogen
    SMARTS[2][9]='([NH:1]([*:2])[*:3].[NH2:4][*:5])>>[N:1]([*:2])([*:3])[*:5].[NH3:4]' #10
    SMARTS[2][10]='([NH2:1][*:2].[NH2:3][*:4])>>[NH:1]([*:2])[*:4].[NH3:3]' #11
    SMARTS[2][11]='([NH:1]=[*:2].[NH2:3][*:4])>>[N:1](=[*:2])[*:4].[NH3:3]' #12
    SMARTS[2][12]='([N:1]#[*:2].[NH:3]=[*:4])>>[N:1](#[*:2])=[*:4].[NH3:4]' #13

    #intramolecular oxygen
    SMARTS[2][13]='([OH:1][*:2].[OH:3][*:4])>>[O:1]([*:2])[*:4].[OH2:3]' #14



    rxn1=[None]*14
    rxn2=[None]*512
    rxn3=[None]*14
    rxn=[rxn1, rxn2, rxn3]

    for i in range(0, len(SMARTS[0])):
        rxn[0][i]=AllChem.ReactionFromSmarts(SMARTS[0][i])

    for i in range(0, len(SMARTS[1])):
        rxn[1][i]=AllChem.ReactionFromSmarts(SMARTS[1][i])
    
    for i in range(0, len(SMARTS[2])):
        rxn[2][i]=AllChem.ReactionFromSmarts(SMARTS[2][i])
        
    outputfilepath = 'Reassembler_Output.txt'
    newinchilist = []
    
    #ENGAGE WITH SITES=1

    if sites==1:
    # =============================================
    # For n=1 (i.e. sites==1) Reassembler runs the simplest loop.
    # It cycles through all n=1 reactions listed in rxn[0].
    # For each reaction it enumerates all possible products of the two input fragments.
    # Since reactions are non-permutable, the process is repeated for the input fragments given in reverse order (second, then first).
    # Products are stored in the result list as SMILES strings, duplicates are avoided.
    # Depending on returnfile value, returns either mol objects or inchies of products
    # =============================================
    
        products=[]

        for i in range (0, len(rxn[0])):
            passProducts=Enumerator.EnumerateReaction(rxn[0][i],(mol1,mol2), uniqueProductsOnly=True)
            passProducts=list(passProducts)
            for j in range(0, len(passProducts)):
                if Chem.MolToSmiles(passProducts[j][0]) not in products:
                    products.append(Chem.MolToSmiles(passProducts[j][0]))
            passProducts=Enumerator.EnumerateReaction(rxn[0][i],(mol2,mol1), uniqueProductsOnly=True)
            passProducts=list(passProducts)
            for j in range(0, len(passProducts)):
                if Chem.MolToSmiles(passProducts[j][0]) not in products:
                    products.append(Chem.MolToSmiles(passProducts[j][0]))
            
        result=(sorted([product for product in products]))

        if returnfile:
            file=open(outputfilepath, 'w') #DIR
            for smiles in result:
                mol=Chem.MolFromSmiles(smiles)
                inchi=Chem.MolToInchi(mol)
                file.write(str(inchi)+'\n')
            file.close()
        else:
            if len(result) == 0:
                return None
            else:
                smiles = result[random.randint(0, len(result)-1)]
                return Chem.MolFromSmiles(smiles)
        

    if sites==2:
    # =============================================
    # For n=2 (i.e. sites==2) Reassembler runs the simplest loop.
    # It cycles through all n=2 reactions listed in rxn[1].
    # For each reaction it enumerates all possible products of the two input fragments.
    # Since reactions are non-permutable, the process is repeated for the input fragments given in reverse order (second, then first).
    # Products are stored in the result list as SMILES strings, duplicates are avoided.
    # Depending on returnfile value, returns either mol objects or inchies of products
    # =============================================
    
        products=[]

        for i in range (0, len(rxn[1])):
            passProducts=Enumerator.EnumerateReaction(rxn[1][i],(mol1, mol2), uniqueProductsOnly=True)
            passProducts=list(passProducts)
            for j in range(0, len(passProducts)):
                if Chem.MolToSmiles(passProducts[j][0]) not in products:
                    products.append(Chem.MolToSmiles(passProducts[j][0]))
            passProducts=Enumerator.EnumerateReaction(rxn[1][i],(mol2, mol1), uniqueProductsOnly=True)
            passProducts=list(passProducts)
            for j in range(0, len(passProducts)):
                if Chem.MolToSmiles(passProducts[j][0]) not in products:
                    products.append(Chem.MolToSmiles(passProducts[j][0]))
        
        result=(sorted([product for product in products]))

        if returnfile:
            file=open(outputfilepath, 'w') #DIR
            for smiles in result:
                mol=Chem.MolFromSmiles(smiles)
                inchi=Chem.MolToInchi(mol)
                file.write(str(inchi)+'\n')
            file.close()
        else:
            if len(result) == 0:
                return None
            else:
                smiles = result[random.randint(0, len(result)-1)]
                return Chem.MolFromSmiles(smiles)


    if sites>2:
        return None # --- forbidden ---



def printer(datafile, foldername):
    """
    Args:
        datafile= txt. file containing inchies of molecules
        foldername = direction in which output .png files are goind to be saved
        
        Generates pictures of molecules generated by the Reassembler.
        This method reads the InChI from the .txt file and generates a series of .png files, each containing pictures of 50 molecules.
    """
    
    try:
        os.mkdir(foldername)
    except:
        pass
    with open(datafile) as file:
        lines= [line.rstrip() for line in file]
    mols=[]
    indexes=[]
    pages=[]
    labels=[]
    for i, line in enumerate(lines):
        if line[:5] == 'InChI': # len(line)>0:
            mols.append(Chem.MolFromInchi(line))
            indexes.append(str(len(mols)))
    for batch in range(0, math.ceil(len(mols)/50)):
        pages.append([])
        labels.append([])
        if len(mols) >= 50:
            pages[batch] = mols[0:50]
            labels[batch] = indexes[0:50]
            mols = mols[50:]
            indexes = indexes[50:]
        else:
            pages[batch] = mols
            labels[batch] = indexes
        img=Draw.MolsToGridImage(pages[batch], molsPerRow=10, legends=labels[batch])
        img.save(foldername + '/Mols_' + str(batch*50) + '-' + str(batch*50+50) + '.png')
        

def filterMol(mol):
    """
    Args:
        mol= mol object of molecule that needs to be checked.
        
        It cycles through the list of SMARTS structures and checks if the input molecule contains any of them as its substructure.
        As soon as one of the listed SMARTS structures if found in the input molecule, the molecule is rejected and filter returns None
        If the filter reaches the end of the SMARTS list without detecting any of them in the molecule, the input mol is returned unchanged
    """
    
    evilSMARTS=51*[None]
    
    evilSMARTS[0]='[*]1~[*]#[*]~1'
    evilSMARTS[1]='[*]1~[*]~[*]#[*]~1'
    evilSMARTS[2]='[*]1~[*]~[*]#[*]~[*]~1'
    evilSMARTS[3]='[*]1~[*]~[*]~[*]#[*]~[*]~1'
    evilSMARTS[4]='[*]1~[*]~[*]~[*]#[*]~[*]~[*]~1'
    evilSMARTS[5]='[*]1=[*]=[*]~1'
    evilSMARTS[6]='[*]1~[*]=[*]=[*]~1'
    evilSMARTS[7]='[*]1~[*]~[*]=[*]=[*]~1'
    evilSMARTS[8]='[*]1~[*]~[*]=[*]=[*]~[*]~1'
    evilSMARTS[9]='[*]1~[*]~[*]~[*]=[*]=[*]~[*]~1'
    evilSMARTS[10]='[*]1~[*]~[*]~[*]=[*]=[*]~[*]~[*]~1'
    evilSMARTS[11]='[*]1~[*]2~[*]=[*]~1~2'
    evilSMARTS[12]='[*]1~[*]2=[*]~1~[*]~2'
    evilSMARTS[13]='[*]1~[*]~[*]2=[*]~[*]~1~2'
    evilSMARTS[14]='[*]1~[*]=[*]2~[*]~[*]~1~2'
    evilSMARTS[15]='[*]1~[*]~[*]2=[*]~1~[*]~2'
    evilSMARTS[16]='[*]1~[*]~[*]2~[*]=[*]~2~[*]~1'
    evilSMARTS[17]='[*]1~[*]~[*]2~[*]~[*]~2=[*]~1'
    evilSMARTS[18]='[*]1~[*]~[*]2=[*](~[*]~1)~[*]~2'
    evilSMARTS[19]='[*]1~[*]~[*]~[*]2=[*]~[*]~2~[*]~1'
    evilSMARTS[20]='[*]1~[*]~[*]=[*]2~[*]~[*]~2~[*]~1'
    evilSMARTS[21]='[*]1~[*]~[*]2=[*]~[*]~[*]~1~2'
    evilSMARTS[22]='[*]1~[*]~[*]2~[*]~[*]=[*]~2~[*]~1'
    evilSMARTS[23]='[*]1~[*]~[*]2~[*]~[*]~[*]~2=[*]~1'
    evilSMARTS[24]='[*]1~[*]2~[*]~[*]~1=[*]~2'
    evilSMARTS[25]='[*]1~[*]~[*]2=[*]~[*]~1~[*]~2'
    evilSMARTS[26]='[*]1~[*]=[*]2~[*]~[*]~1~[*]~2'
    evilSMARTS[27]='[*]1~[*]~[*]2~[*]~[*](=[*]~2)~[*]~1'
    evilSMARTS[28]='[*]1~[*]~[*]2~[*]~[*](=[*]~1)~[*]~2'
    evilSMARTS[29]='[*]1~[*]~[*]2=[*]~[*]~1~[*]~[*]~2'
    evilSMARTS[30]='[*]1~[*]~[*]2=[*]~[*]~[*]~1~[*]~2'
    evilSMARTS[31]='[*]1~[*]~[*]2~[*]~[*]~[*](=[*]~2)~[*]~1'
    evilSMARTS[32]='[*]1~[*]~[*]2~[*]~[*]=[*](~[*]~1)~[*]~2'
    evilSMARTS[33]='[*]1~[*]~[*]2~[*]~[*]~[*](=[*]~1)~[*]~2'
    evilSMARTS[34]='[*]1~[*]~[*]2=[*]~[*]~[*]~1~[*]~[*]~2'
    evilSMARTS[35]='[*]1~[*]2~[*]3~[*]~[*]~1~2~3'
    evilSMARTS[36]='[*]1~[*]~[*]23~[*]4~[*]~2~[*]~1~3~4'
    evilSMARTS[37]='[*]1~[*]23~[*]~[*]~1(~[*]~2)~[*]~3'
    evilSMARTS[38]='[*]1~[*]2:[*]:[*]:[*]:[*]:[*]:2~1'
    evilSMARTS[39]='[*]1~[*]~[*]2:[*]:[*]:[*]:[*]:[*]:2~1'
    evilSMARTS[40]='[*]1~[*]2:[*]:[*]:[*]:[*]~1:[*]:2'
    evilSMARTS[41]='[*]1~[*]~[*]2:[*]:[*]:[*]:[*]~1:[*]:2'
    evilSMARTS[42]='[*]1~[*]~[*]2:[*]:[*]:[*]:[*](:[*]:2)~[*]~1'
    evilSMARTS[43]='[*]1~[*]2:[*]:[*]:[*]~1:[*]:[*]:2'
    evilSMARTS[44]='[*]1~[*]~[*]2:[*]:[*]:[*]~1:[*]:[*]:2'
    evilSMARTS[45]='[*]1~[*]~[*]2:[*]:[*]:[*](:[*]:[*]:2)~[*]~1'
    evilSMARTS[46]='[*]1:[*]:[*]2:[*]:[*]~2:[*]:1'
    evilSMARTS[47]='[*]1:[*]:[*]2:[*]:[*]:[*]:1~2'
    evilSMARTS[48]='[*]1~[*]~[*]~[*]2:[*]:[*]:[*]:[*](:[*]:2)~[*]~1'
    evilSMARTS[49]='[*]1~[*]~[*]~[*]2:[*]:[*]:[*]:[*](:[*]:2)~[*]~[*]~1'
    evilSMARTS[50]='[*]1~[*]~[*]~[*]2:[*]:[*]:[*](:[*]:[*]:2)~[*]~1'
    
    for i, item in enumerate(evilSMARTS):
        subMol=Chem.MolFromSmarts(item)
        if mol.HasSubstructMatch(subMol)==True:
            return None
        elif i==50:
            return mol


def origami(mol, returnfile=False):
    """
    Args:
        mol= mol object containing the fragment that undergoes internall connection with itself
        returnfile: if False, then assembly products are return as mol objects, otherwise if True returns a file with product InChI
        
        origami_v1.1
        This method executes one origami loop.
        Which means, it created RDKit reaction objects from the list of SMARTS that describe origami connections.
        Origami connections are the ones where one molecule undergoes internal connection with itself.
        It cycles through all origami reactions listed in rxn and feeds them the input mol to enumerate all possible products.
        Before product is stored it is being checked for validity:
        - if the number of atoms in the origami product is not as expected (i.e. number of atoms in pre-origami substrate minus one) or
        - if the product does not contain each of the input fragments as its substructures then
        it is discarded as the case of bond fusion / other invalid connection.
        Products are stored in the result list as mol objects, duplicates are avoided.
    """

    SMARTS=[None]*14
    
    #intramolecular carbon sp3
    SMARTS[0]='([CH:1]([*:2])([*:3])[*:4].[CH3:5][*:6])>>[C:1]([*:2])([*:3])([*:4])[*:6].[CH4:5]' #1
    SMARTS[1]='([CH2:1]([*:2])[*:3].[CH2:4]([*:5])[*:6])>>[C:1]([*:2])([*:3])([*:5])[*:6].[CH4:4]' #2
    SMARTS[2]='([CH2:1]([*:2])[*:3].[CH3:4][*:5])>>[CH:1]([*:2])([*:3])[*:5].[CH4:4]' #3
    SMARTS[3]='([CH3:1][*:2].[CH3:4][*:5])>>[CH2:1]([*:2])[*:5].[CH4:4]' #4

    #intramolecular carbon sp2
    SMARTS[4]='([CH:1](=[*:2])[*:3].[CH3:4][*:5])>>[C:1](=[*:2])([*:3])[*:5].[CH4:4]' #5
    SMARTS[5]='([CH2:1]=[*:2].[CH2:3]([*:4])[*:5])>>[C:1](=[*:2])([*:4])[*:5].[CH4:3]' #6
    SMARTS[6]='([CH2:1]=[*:2].[CH3:3][*:4])>>[CH:1](=[*:2])[*:4].[CH4:3]' #7
    SMARTS[7]='([CH2:1]=[*:2].[CH2:3]=[*:4])>>[C:1](=[*:2])=[*:4].[CH4:3]' #8

    #intramolecular carbon sp
    SMARTS[8]='([CH:1]#[*:2].[CH3:3][*:4])>>[C:1](#[*:2])[*:4].[CH4:3]' #9

    #intramolecular nitrogen
    SMARTS[9]='([NH:1]([*:2])[*:3].[NH2:4][*:5])>>[N:1]([*:2])([*:3])[*:5].[NH3:4]' #10
    SMARTS[10]='([NH2:1][*:2].[NH2:3][*:4])>>[NH:1]([*:2])[*:4].[NH3:3]' #11
    SMARTS[11]='([NH:1]=[*:2].[NH2:3][*:4])>>[N:1](=[*:2])[*:4].[NH3:3]' #12
    SMARTS[12]='([N:1]#[*:2].[NH:3]=[*:4])>>[N:1](#[*:2])=[*:4].[NH3:4]' #13

    #intramolecular oxygen
    SMARTS[13]='([OH:1][*:2].[OH:3][*:4])>>[O:1]([*:2])[*:4].[OH2:3]' #14

    rxn=[None]*14
    
    for i in range(0, len(SMARTS)):
        rxn[i]=AllChem.ReactionFromSmarts(SMARTS[i])
    
    outputfilepath = 'Reassembler_Output.txt'
    newmollist = []
    allProducts=[]
    uniqueProducts=[]
    numAtoms=mol.GetNumAtoms()
    for i in range(0, len(rxn)):
        try:
            passProduct=rxn[i].RunReactant(mol, 0)
            for j in range (0, len(passProduct)):
                newNumAtoms=passProduct[j][0].GetNumAtoms()
                if newNumAtoms==(numAtoms-1):
                    if Chem.MolToSmiles(passProduct[j][0]) not in uniqueProducts:
                        uniqueProducts.append(Chem.MolToSmiles(passProduct[j][0]))
        except:
            continue
    allProducts+=uniqueProducts
    result=allProducts

    if returnfile:
        file=open(outputfilepath, 'w') #DIR
        for smiles in result:
            mol=Chem.MolFromSmiles(smiles)
            inchi=Chem.MolToInchi(mol)
            file.write(str(inchi)+'\n')
        file.close()
    else:
        for smiles in result:
            mol=Chem.MolFromSmiles(smiles)
            newmollist.append(mol)
    
    return newmollist



def confilter(mol):
    """
    Args:
        mol= mol object of molecule that needs to be checked.
        
        It sanitized the mol object, adds hydrogens and then tries to find a conformation for the molecule.
        If any conformation is found (EmbedMolecule() returns 0), then input molecule is returned in unchanged form
        If no conformation could be found at all (EmbedMolecule() returns -1), then molecule is rejected and None is returned
    """
    
    Chem.SanitizeMol(mol)
    molH=Chem.AddHs(mol)
    score=AllChem.EmbedMolecule(molH)
    
    if score==0:
        return mol
    elif score==-1:
        return None
    else:
        error = 'confilter crashed'
        return error
